{"version":3,"sources":["webpack:///./src/ui/src/helpers/getAnnotationStyles.js","webpack:///./src/ui/src/components/AnnotationStylePopup/AnnotationStylePopup.scss?3394","webpack:///./src/ui/src/components/AnnotationStylePopup/AnnotationStylePopup.scss","webpack:///./src/ui/src/components/AnnotationStylePopup/AnnotationStylePopup.js","webpack:///./src/ui/src/components/AnnotationStylePopup/index.js","webpack:///./src/ui/src/components/AnnotationPopup/AnnotationPopup.scss?819b","webpack:///./src/ui/src/components/CalibrationPopup/CalibrationPopup.scss?bc6f","webpack:///./src/ui/src/components/CalibrationPopup/CalibrationPopup.scss","webpack:///./src/ui/src/components/AnnotationPopup/AnnotationPopup.scss","webpack:///./src/ui/src/components/DatePicker/DatePicker.js","webpack:///./src/ui/src/components/DatePicker/index.js","webpack:///./src/ui/src/components/CalibrationPopup/CalibrationPopup.js","webpack:///./src/ui/src/components/CalibrationPopup/index.js","webpack:///./src/ui/src/components/AnnotationPopup/AnnotationPopup.js","webpack:///./src/ui/src/components/AnnotationPopup/AnnotationPopupContainer.js","webpack:///./src/ui/src/components/AnnotationPopup/index.js"],"names":["annotation","style","forEach","property","value","elementName","core","isBlendModeSupported","Opacity","isFormFieldPlaceholder","api","content","__esModule","default","module","i","options","styleTag","webComponents","document","getElementsByTagName","length","clonedStyleTags","webComponent","shadowRoot","appendChild","onload","styleNode","innerHTML","cloneNode","push","head","exports","locals","AnnotationStylePopup","FreeTextAnnotation","window","Core","Annotations","getAutoSizeType","AutoSizeTypes","NONE","doc","getDocument","pageNumber","pageInfo","getPageInfo","pageMatrix","getPageMatrix","pageRotation","getPageRotation","fitText","annotations","props","annotationManager","getAnnotationManager","redrawAnnotation","isToolDefaultStyleUpdateFromAnnotationPopupEnabled","setAnnotationStyles","setToolStyles","ToolName","adjustFreeTextBoundingBox","updateAnnotationRichTextStyle","section","lineStyle","setStartStyle","setEndStyle","dashes","split","shift","trigger","e","isMobile","target","currentTarget","closeElement","onResize","this","isDisabled","isRedaction","isFreeText","isEllipse","isMeasure","colorMapKey","showLineStyleOptions","properties","hideSnapModeCheckbox","className","getClassName","handleResize","measureRef","data-element","DataElements","ANNOTATION_STYLE_POPUP","onClick","handleClick","ref","hasBackToMenu","ANNOTATION_STYLE_POPUP_BACK_BUTTON_CONTAINER","ActionButton","dataElement","ANNOTATION_STYLE_POPUP_BACK_BUTTON","label","img","onBackToMenu","StylePopup","onStyleChange","handleStyleChange","onSliderChange","handleSliderChange","onPropertyChange","handlePropertyChange","disableSeparator","onRichTextStyleChange","handleRichTextStyleChange","onLineStyleChange","handleLineStyleChange","React","Component","PropTypes","bool","array","isRequired","object","func","mapDispatchToProps","actions","connect","state","selectors","isElementDisabled","withTranslation","DatePicker","onDatePickerShow","dateRef","useRef","dateContainerRef","useEffect","datePicker","createDatePicker","field","current","container","format","getDateFormat","getDatePicker","destroy","propTypes","Scale","parseMeasurementContentsByAnnotation","factor","Measure","axis","getLineLength","CalibrationPropType","shape","arrayOf","CalibrationPopup","t","useTranslation","dispatch","useDispatch","useSelector","getMeasurementUnits","getCalibrationInfo","shallowEqual","measurementUnits","tempScale","isFractionalUnit","defaultUnit","useState","valueDisplay","setValueDisplay","inputRef","unitTo","worldScale","unit","unitToOptions","to","filter","fractionalUnits","includes","isFractionalUnitsToggleDisabled","valueInputType","inputValueClass","classNames","updateTempScale","scaleValue","scaleUnit","pageUnit","currentDistance","currentScale","newRatio","pageScale","defaultPageUnit","metricUnits","defaultPageValue","convertUnit","updateCalibrationInfo","setValue","updateValueDisplay","newValueDisplay","getFormattedValue","tempScaleRef","onAnnotationChanged","action","currentUnit","addEventListener","removeEventListener","deleteAnnotations","activeElement","type","min","onChange","inputValue","trim","inFractionalRegex","test","result","parseInFractional","ftInFractionalRegex","parseFtInFractional","ftInDecimalRegex","parseFtInDecimal","floatRegex","parseFloat","onBlur","placeholder","hintValues","Tooltip","Dropdown","items","currentSelectionKey","onClickItem","Choice","isSwitch","leftLabel","disabled","checked","id","isIE","isOpen","isRightClickMenu","isNotesPanelOpenOrActive","isRichTextPopupOpen","isLinkModalOpen","focusedAnnotation","popupRef","any","position","showViewFileButton","onViewFile","showCommentButton","onCommentAnnotation","isDateFreeTextCanEdit","isDatePickerOpen","handleDateChange","isCalibrationPopupOpen","showEditStyleButton","isStylePopupOpen","openEditStylePopup","closeEditStylePopup","annotationStyle","showContentEditButton","onEditContent","openContentEditDeleteWarningModal","isAppearanceSignature","onClearAppearanceSignature","showRedactionButton","onApplyRedaction","showGroupButton","onGroupAnnotations","showUngroupButton","onUngroupAnnotations","showFormFieldButton","onOpenFormField","showDeleteButton","onDeleteAnnotation","showLinkButton","hasAssociatedLink","linkAnnotationToURL","showFileDownloadButton","downloadFileAttachment","showAudioPlayButton","handlePlaySound","showCalibrateButton","onOpenCalibration","AnnotationPopup","shortCutKeysFor3DVisible","setShortCutKeysFor3DVisible","commentButtonLabel","commentButtonImg","show3DShortCutButton","Model3DAnnotation","isRectangle","RectangleAnnotation","EllipseAnnotation","isPolygon","PolygonAnnotation","getIntent","Intent","FreeText","FreeTextCallout","RedactionAnnotation","mapAnnotationToKey","getDataWithKey","mapToolNameToKey","hasLineEndings","isInstanceActive","isApryseWebViewerWebComponent","getRootNode","StrokeStyle","isContentEdit","isContentEditPlaceholder","err","console","error","StartLineStyle","getStartStyle","EndLineStyle","getEndStyle","richTextStyles","getRichTextStyle","Font","FontSize","TextAlign","TextVerticalAlign","bold","italic","underline","strikeout","OverlayText","annotationPopup","Popup","open","closed","stylePopupOpen","ANNOTATION_POPUP","FocusTrap","locked","CustomizablePopup","childrenClassName","title","CALIBRATION_POPUP_BUTTON","renderPopup","cancel","ToolNames","Tools","selectedMultipleAnnotations","canModify","setIsStylePopupOpen","setDatePickerOpen","isDatePickerMount","setDatePickerMount","includesFormFieldAnnotation","stylePopupRepositionFlag","setStylePopupRepositionFlag","closePopup","AnnotationPopupContainer","isElementOpen","isRightClickAnnotationPopupEnabled","NOTES_PANEL","INLINE_COMMENT_POPUP","LINK_MODAL","getIsMultiTab","getTabManager","getTabs","getNotesInLeftPanel","LEFT_PANEL","getActiveLeftPanel","isNotesPanelDisabled","isAnnotationStylePopupDisabled","isInlineCommentingDisabled","isNotesPanelOpen","isMultiTab","tabManager","tabs","notesInLeftPanel","leftPanelOpen","activeLeftPanel","left","top","setPosition","setCalibrationPopupOpen","isFocusedAnnotationSelected","isAnnotationSelected","annotManager","useOnClickOutside","useCallback","notesPanel","querySelector","clickedInNotesPanel","contains","clickedInLinkModal","warningModal","getOpenedWarningModal","colorPicker","getOpenedColorPicker","useLayoutEffect","getAnnotationPopupPositionBasedOn","CALIBRATION_MEASUREMENT","acceptFormats","getHashParameters","SupportedFileFormats","SERVER","CLIENT","FileAttachmentAnnotation","mimeTypeToExtension","getFileMetadata","mimeType","warn","metaData","fileAttachmentTab","find","tab","filename","setActiveTab","getFileData","extension","saveCurrentActiveTabState","setActive","addTab","selectedAnnotations","getSelectedAnnotations","numberOfSelectedAnnotations","multipleAnnotationsSelected","canModifyContents","numberOfGroups","getNumberOfGroups","canGroup","canUngroup","SignatureWidgetAnnotation","isSignedByAppearance","CROP","isUncommittedContentEditPlaceholder","getAnnotationStyles","hasStyle","Object","keys","toolsWithNoStyling","RADIO_FORM_FIELD","CHECK_BOX_FIELD","VIDEO_REDACTION","VIDEO_AND_AUDIO_REDACTION","AUDIO_REDACTION","isFullPDFEnabled","getContentEditType","ContentEdit","Types","TEXT","getDocumentContent","setCurrentContentBeingEdited","openElement","CONTENT_EDIT_MODAL","isAnnotationRedactable","primaryAnnotation","selectedAnnotation","InReplyTo","isInFormFieldCreationMode","getFormFieldCreationManager","SIGNATURE","REDACTION","REDACTION2","REDACTION3","REDACTION4","STICKY","STICKY2","STICKY3","STICKY4","SoundAnnotation","LineAnnotation","hasAudioData","contentEditManager","getContentEditManager","isInContentEditMode","endContentEditMode","triggerNoteEditing","text","setNoteContents","updateAnnotation","isDatePickerShowed","warning","message","confirmBtnText","onConfirm","showWarningMessage","clearSignature","applyRedactions","groupAnnotations","ungroupAnnotations","disableElement","PRIORITY_THREE","FORM_FIELD_EDIT_POPUP","annot","getGroupedLinkAnnotations","linkAnnot","index","TextHighlightAnnotation","deleteAnnotation","setActiveSoundAnnotation","triggerResetAudioPlaybackPosition","CALIBRATION_MODAL","memo"],"mappings":"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","file":"chunks/19.chunk.js","sourcesContent":["import core from 'core';\n\n/**\n * We can just pass object down as a prop, but many properties of that object won't be used by the child component,\n * so here we select properties that will be used.\n * @ignore\n * @param annotation is an annotation created by a tool\n * @return current style of that object.\n */\nexport default (annotation) => {\n  const styleProperty = [\n    'FillColor',\n    'StrokeColor',\n    'TextColor',\n    'Opacity',\n    'StrokeThickness',\n    'FontSize',\n    'Precision',\n    'Scale',\n    'Style',\n  ];\n  const style = {};\n\n  styleProperty.forEach((property) => {\n    const value = annotation[property];\n\n    if (value !== null && value !== undefined) {\n      style[property] = annotation[property];\n    }\n  });\n\n  // Special case for the highlight annotation. It only have opacity when blend mode is working\n  if (annotation.elementName === 'highlight' && !core.isBlendModeSupported(annotation['BlendMode'])) {\n    style.Opacity = null;\n  }\n\n  // widget don't support opacity\n  if (annotation.isFormFieldPlaceholder()) {\n    style.Opacity = null;\n  }\n\n  return style;\n};\n","var api = require(\"!../../../../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\");\n            var content = require(\"!!../../../../../node_modules/css-loader/index.js!../../../../../node_modules/postcss-loader/src/index.js??postcss!../../../../../node_modules/sass-loader/dist/cjs.js!./AnnotationStylePopup.scss\");\n\n            content = content.__esModule ? content.default : content;\n\n            if (typeof content === 'string') {\n              content = [[module.id, content, '']];\n            }\n\nvar options = {};\n\noptions.insert = function (styleTag) {\n                const webComponents = document.getElementsByTagName('apryse-webviewer');\n                if (webComponents.length > 0) {\n                  const clonedStyleTags = [];\n                  for (let i = 0; i < webComponents.length; i++) {\n                    const webComponent = webComponents[i];\n                    if (i === 0) {\n                      webComponent.shadowRoot.appendChild(styleTag);\n                      styleTag.onload = function () {\n                        if (clonedStyleTags.length > 0) {\n                          clonedStyleTags.forEach((styleNode) => {\n                            // eslint-disable-next-line no-unsanitized/property\n                            styleNode.innerHTML = styleTag.innerHTML;\n                          });\n                        }\n                      };\n                    } else {\n                      const styleNode = styleTag.cloneNode(true);\n                      webComponent.shadowRoot.appendChild(styleNode);\n                      clonedStyleTags.push(styleNode);\n                    }\n                  }\n                } else {\n                  document.head.appendChild(styleTag);\n                }\n              };\noptions.singleton = false;\n\nvar update = api(content, options);\n\n\n\nmodule.exports = content.locals || {};","exports = module.exports = require(\"../../../../../node_modules/css-loader/lib/css-base.js\")(false);\n// imports\n\n\n// module\nexports.push([module.id, \":host{display:inline-block;container-type:inline-size;width:100%;height:100%;overflow:hidden}@media(min-width:901px){.App:not(.is-web-component) .hide-in-desktop{display:none}}@container (min-width: 901px){.hide-in-desktop{display:none}}@media(min-width:641px)and (max-width:900px){.App:not(.is-in-desktop-only-mode):not(.is-web-component) .hide-in-tablet{display:none}}@container (min-width: 641px) and (max-width: 900px){.App.is-web-component:not(.is-in-desktop-only-mode) .hide-in-tablet{display:none}}@media(max-width:640px)and (min-width:431px){.App:not(.is-web-component) .hide-in-mobile{display:none}}@container (max-width: 640px) and (min-width: 431px){.App.is-web-component .hide-in-mobile{display:none}}@media(max-width:430px){.App:not(.is-web-component) .hide-in-small-mobile{display:none}}@container (max-width: 430px){.App.is-web-component .hide-in-small-mobile{display:none}}.always-hide{display:none}@-webkit-keyframes bottom-up{0%{transform:translateY(100%)}to{transform:translateY(0)}}@keyframes bottom-up{0%{transform:translateY(100%)}to{transform:translateY(0)}}@-webkit-keyframes up-bottom{0%{transform:translateY(0)}to{transform:translateY(100%)}}@keyframes up-bottom{0%{transform:translateY(0)}to{transform:translateY(100%)}}@media(max-width:640px){.App:not(.is-in-desktop-only-mode):not(.is-web-component) .AnnotationStylePopup{width:100%;margin:0;position:relative;max-width:none;border-radius:4px 4px 0 0;border:0;padding-bottom:24px;box-shadow:none}}@container (max-width: 640px){.App.is-web-component:not(.is-in-desktop-only-mode) .AnnotationStylePopup{width:100%;margin:0;position:relative;max-width:none;border-radius:4px 4px 0 0;border:0;padding-bottom:24px;box-shadow:none}}.AnnotationStylePopup .back-to-menu-container{margin-top:var(--padding-medium);margin-right:var(--padding-medium);margin-left:var(--padding-medium);padding-bottom:var(--padding-small);border-bottom:1px solid var(--border)}.AnnotationStylePopup .Button.back-to-menu-button{margin:0;width:100%;height:32px;border-radius:0;justify-content:flex-start}@media(max-width:640px){.App:not(.is-in-desktop-only-mode):not(.is-web-component) .AnnotationStylePopup .Button.back-to-menu-button{width:100%;height:32px}}@container (max-width: 640px){.App.is-web-component:not(.is-in-desktop-only-mode) .AnnotationStylePopup .Button.back-to-menu-button{width:100%;height:32px}}\", \"\"]);\n\n// exports\nexports.locals = {\n\t\"LEFT_HEADER_WIDTH\": \"41px\",\n\t\"RIGHT_HEADER_WIDTH\": \"41px\"\n};","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { connect } from 'react-redux';\nimport Measure from 'react-measure';\nimport { withTranslation } from 'react-i18next';\n\nimport StylePopup from 'components/StylePopup';\n\nimport core from 'core';\nimport getClassName from 'helpers/getClassName';\nimport setToolStyles from 'helpers/setToolStyles';\nimport { isMobile } from 'helpers/device';\nimport actions from 'actions';\nimport selectors from 'selectors';\nimport DataElements from 'src/constants/dataElement';\n\nimport './AnnotationStylePopup.scss';\nimport ActionButton from '../ActionButton';\n\nclass AnnotationStylePopup extends React.Component {\n  static propTypes = {\n    isDisabled: PropTypes.bool,\n    isToolDefaultStyleUpdateFromAnnotationPopupEnabled: PropTypes.bool,\n    annotations: PropTypes.array.isRequired,\n    style: PropTypes.object.isRequired,\n    properties: PropTypes.object.isRequired,\n    isRedaction: PropTypes.bool,\n    isFreeText: PropTypes.bool,\n    isEllipse: PropTypes.bool,\n    closeElement: PropTypes.func.isRequired,\n    hasBackToMenu: PropTypes.bool,\n    onBackToMenu: PropTypes.func,\n  };\n\n  adjustFreeTextBoundingBox = (annotation) => {\n    const { FreeTextAnnotation } = window.Core.Annotations;\n    if (annotation instanceof FreeTextAnnotation && annotation.getAutoSizeType() !== FreeTextAnnotation.AutoSizeTypes.NONE) {\n      const doc = core.getDocument();\n      const pageNumber = annotation['PageNumber'];\n      const pageInfo = doc.getPageInfo(pageNumber);\n      const pageMatrix = doc.getPageMatrix(pageNumber);\n      const pageRotation = doc.getPageRotation(pageNumber);\n      annotation.fitText(pageInfo, pageMatrix, pageRotation);\n    }\n  }\n\n  handleSliderChange = (property, value) => {\n    const { annotations } = this.props;\n    const annotationManager = core.getAnnotationManager();\n    annotations.forEach((annotation) => {\n      annotation[property] = value;\n      annotationManager.redrawAnnotation(annotation);\n    });\n  }\n\n  handlePropertyChange = (property, value) => {\n    const { annotations, isToolDefaultStyleUpdateFromAnnotationPopupEnabled } = this.props;\n\n    annotations.forEach((annotation) => {\n      core.setAnnotationStyles(annotation, {\n        [property]: value,\n      });\n      if (isToolDefaultStyleUpdateFromAnnotationPopupEnabled) {\n        setToolStyles(annotation.ToolName, property, value);\n      }\n      if (property === 'FontSize' || property === 'Font') {\n        this.adjustFreeTextBoundingBox(annotation);\n      }\n    });\n  }\n\n  handleStyleChange = (property, value) => {\n    const { annotations, isToolDefaultStyleUpdateFromAnnotationPopupEnabled } = this.props;\n\n    annotations.forEach((annotation) => {\n      core.setAnnotationStyles(annotation, {\n        [property]: value,\n      });\n\n      if (isToolDefaultStyleUpdateFromAnnotationPopupEnabled) {\n        setToolStyles(annotation.ToolName, property, value);\n      }\n    });\n  };\n\n  handleRichTextStyleChange = (property, value) => {\n    const { annotations } = this.props;\n\n    annotations.forEach((annotation) => {\n      core.updateAnnotationRichTextStyle(annotation, { [property]: value });\n    });\n  }\n\n  handleLineStyleChange = (section, value) => {\n    const { annotations, isToolDefaultStyleUpdateFromAnnotationPopupEnabled } = this.props;\n\n    annotations.forEach((annotation) => {\n      let lineStyle = '';\n      if (section === 'start') {\n        annotation.setStartStyle(value);\n        lineStyle = 'StartLineStyle';\n      } else if (section === 'end') {\n        annotation.setEndStyle(value);\n        lineStyle = 'EndLineStyle';\n      } else if (section === 'middle') {\n        const dashes = value.split(',');\n        const style = dashes.shift();\n        annotation['Style'] = style;\n        annotation['Dashes'] = dashes;\n        lineStyle = 'StrokeStyle';\n      }\n\n      if (isToolDefaultStyleUpdateFromAnnotationPopupEnabled) {\n        setToolStyles(annotation.ToolName, lineStyle, value);\n      }\n\n      core.getAnnotationManager().redrawAnnotation(annotation);\n    });\n\n    core.getAnnotationManager().trigger('annotationChanged', [annotations, 'modify', {}]);\n  };\n\n  handleClick = (e) => {\n    if (isMobile() && e.target === e.currentTarget) {\n      this.props.closeElement('annotationPopup');\n    }\n  }\n\n  handleResize = () => {\n    const { onResize } = this.props;\n    onResize && onResize();\n  }\n\n  render() {\n    const {\n      isDisabled,\n      style, isRedaction,\n      isFreeText,\n      isEllipse,\n      isMeasure,\n      colorMapKey,\n      showLineStyleOptions,\n      properties,\n      hideSnapModeCheckbox,\n    } = this.props;\n\n    const className = getClassName('Popup AnnotationStylePopup', this.props);\n\n    if (isDisabled) {\n      return null;\n    }\n\n    return (\n      <Measure\n        onResize={this.handleResize}\n      >\n        {({ measureRef }) => (\n          <div\n            className={className}\n            data-element={DataElements.ANNOTATION_STYLE_POPUP}\n            onClick={this.handleClick}\n            ref={measureRef}\n          >\n            {this.props.hasBackToMenu &&\n              <div\n                className=\"back-to-menu-container\"\n                data-element={DataElements.ANNOTATION_STYLE_POPUP_BACK_BUTTON_CONTAINER}\n              >\n                <ActionButton\n                  className=\"back-to-menu-button\"\n                  dataElement={DataElements.ANNOTATION_STYLE_POPUP_BACK_BUTTON}\n                  label=\"action.backToMenu\"\n                  img=\"icon-chevron-left\"\n                  onClick={this.props.onBackToMenu}\n                />\n              </div>\n            }\n            {/* Do not show checkbox for ellipse as snap mode does not exist for it */}\n            <StylePopup\n              hideSnapModeCheckbox={hideSnapModeCheckbox}\n              colorMapKey={colorMapKey}\n              style={style}\n              isFreeText={isFreeText}\n              isEllipse={isEllipse}\n              isMeasure={isMeasure}\n              onStyleChange={this.handleStyleChange}\n              onSliderChange={this.handleSliderChange}\n              onPropertyChange={this.handlePropertyChange}\n              disableSeparator\n              properties={properties}\n              onRichTextStyleChange={this.handleRichTextStyleChange}\n              isRedaction={isRedaction}\n              showLineStyleOptions={showLineStyleOptions}\n              onLineStyleChange={this.handleLineStyleChange}\n            />\n          </div>\n        )}\n      </Measure>\n    );\n  }\n}\n\nconst mapStateToProps = (state) => ({\n  isDisabled: selectors.isElementDisabled(state, 'annotationStylePopup'),\n  isToolDefaultStyleUpdateFromAnnotationPopupEnabled: selectors.isToolDefaultStyleUpdateFromAnnotationPopupEnabled(state)\n});\n\nconst mapDispatchToProps = {\n  closeElement: actions.closeElement,\n};\n\nexport default connect(\n  mapStateToProps,\n  mapDispatchToProps,\n)(withTranslation()(AnnotationStylePopup));\n","import AnnotationStylePopup from './AnnotationStylePopup';\n\nexport default AnnotationStylePopup;","var api = require(\"!../../../../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\");\n            var content = require(\"!!../../../../../node_modules/css-loader/index.js!../../../../../node_modules/postcss-loader/src/index.js??postcss!../../../../../node_modules/sass-loader/dist/cjs.js!./AnnotationPopup.scss\");\n\n            content = content.__esModule ? content.default : content;\n\n            if (typeof content === 'string') {\n              content = [[module.id, content, '']];\n            }\n\nvar options = {};\n\noptions.insert = function (styleTag) {\n                const webComponents = document.getElementsByTagName('apryse-webviewer');\n                if (webComponents.length > 0) {\n                  const clonedStyleTags = [];\n                  for (let i = 0; i < webComponents.length; i++) {\n                    const webComponent = webComponents[i];\n                    if (i === 0) {\n                      webComponent.shadowRoot.appendChild(styleTag);\n                      styleTag.onload = function () {\n                        if (clonedStyleTags.length > 0) {\n                          clonedStyleTags.forEach((styleNode) => {\n                            // eslint-disable-next-line no-unsanitized/property\n                            styleNode.innerHTML = styleTag.innerHTML;\n                          });\n                        }\n                      };\n                    } else {\n                      const styleNode = styleTag.cloneNode(true);\n                      webComponent.shadowRoot.appendChild(styleNode);\n                      clonedStyleTags.push(styleNode);\n                    }\n                  }\n                } else {\n                  document.head.appendChild(styleTag);\n                }\n              };\noptions.singleton = false;\n\nvar update = api(content, options);\n\n\n\nmodule.exports = content.locals || {};","var api = require(\"!../../../../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\");\n            var content = require(\"!!../../../../../node_modules/css-loader/index.js!../../../../../node_modules/postcss-loader/src/index.js??postcss!../../../../../node_modules/sass-loader/dist/cjs.js!./CalibrationPopup.scss\");\n\n            content = content.__esModule ? content.default : content;\n\n            if (typeof content === 'string') {\n              content = [[module.id, content, '']];\n            }\n\nvar options = {};\n\noptions.insert = function (styleTag) {\n                const webComponents = document.getElementsByTagName('apryse-webviewer');\n                if (webComponents.length > 0) {\n                  const clonedStyleTags = [];\n                  for (let i = 0; i < webComponents.length; i++) {\n                    const webComponent = webComponents[i];\n                    if (i === 0) {\n                      webComponent.shadowRoot.appendChild(styleTag);\n                      styleTag.onload = function () {\n                        if (clonedStyleTags.length > 0) {\n                          clonedStyleTags.forEach((styleNode) => {\n                            // eslint-disable-next-line no-unsanitized/property\n                            styleNode.innerHTML = styleTag.innerHTML;\n                          });\n                        }\n                      };\n                    } else {\n                      const styleNode = styleTag.cloneNode(true);\n                      webComponent.shadowRoot.appendChild(styleNode);\n                      clonedStyleTags.push(styleNode);\n                    }\n                  }\n                } else {\n                  document.head.appendChild(styleTag);\n                }\n              };\noptions.singleton = false;\n\nvar update = api(content, options);\n\n\n\nmodule.exports = content.locals || {};","exports = module.exports = require(\"../../../../../node_modules/css-loader/lib/css-base.js\")(false);\n// imports\n\n\n// module\nexports.push([module.id, \":host{display:inline-block;container-type:inline-size;width:100%;height:100%;overflow:hidden}@media(min-width:901px){.App:not(.is-web-component) .hide-in-desktop{display:none}}@container (min-width: 901px){.hide-in-desktop{display:none}}@media(min-width:641px)and (max-width:900px){.App:not(.is-in-desktop-only-mode):not(.is-web-component) .hide-in-tablet{display:none}}@container (min-width: 641px) and (max-width: 900px){.App.is-web-component:not(.is-in-desktop-only-mode) .hide-in-tablet{display:none}}@media(max-width:640px)and (min-width:431px){.App:not(.is-web-component) .hide-in-mobile{display:none}}@container (max-width: 640px) and (min-width: 431px){.App.is-web-component .hide-in-mobile{display:none}}@media(max-width:430px){.App:not(.is-web-component) .hide-in-small-mobile{display:none}}@container (max-width: 430px){.App.is-web-component .hide-in-small-mobile{display:none}}.always-hide{display:none}@-webkit-keyframes bottom-up{0%{transform:translateY(100%)}to{transform:translateY(0)}}@keyframes bottom-up{0%{transform:translateY(100%)}to{transform:translateY(0)}}@-webkit-keyframes up-bottom{0%{transform:translateY(0)}to{transform:translateY(100%)}}@keyframes up-bottom{0%{transform:translateY(0)}to{transform:translateY(100%)}}.CalibrationPopup{display:flex;flex-direction:column;align-items:flex-start;padding:12px;width:220px;height:84px;background:#fff;box-shadow:0 0 3px #868e96;border-radius:4px}.CalibrationPopup .pop-switch{margin-top:12px}.CalibrationPopup .pop-switch.ui__choice--disabled .ui__choice__label{color:#cfd4da}.CalibrationPopup .input-container{display:flex;flex-direction:row;justify-content:space-between;align-items:flex-start;width:196px;height:32px}.CalibrationPopup .input-container .input-field{width:94px;height:32px}.CalibrationPopup .input-container .input-field.invalid-value{border-color:red}.CalibrationPopup .input-container .input-field .Dropdown__wrapper{width:100%;height:100%}.CalibrationPopup .input-container .input-field .Dropdown__wrapper .Dropdown{height:100%;text-align:left}.CalibrationPopup .input-container .input-field .Dropdown__wrapper .Dropdown__items{width:100%}\", \"\"]);\n\n// exports\nexports.locals = {\n\t\"LEFT_HEADER_WIDTH\": \"41px\",\n\t\"RIGHT_HEADER_WIDTH\": \"41px\"\n};","exports = module.exports = require(\"../../../../../node_modules/css-loader/lib/css-base.js\")(false);\n// imports\n\n\n// module\nexports.push([module.id, \".open.AnnotationPopup{visibility:visible}.closed.AnnotationPopup{visibility:hidden}:host{display:inline-block;container-type:inline-size;width:100%;height:100%;overflow:hidden}@media(min-width:901px){.App:not(.is-web-component) .hide-in-desktop{display:none}}@container (min-width: 901px){.hide-in-desktop{display:none}}@media(min-width:641px)and (max-width:900px){.App:not(.is-in-desktop-only-mode):not(.is-web-component) .hide-in-tablet{display:none}}@container (min-width: 641px) and (max-width: 900px){.App.is-web-component:not(.is-in-desktop-only-mode) .hide-in-tablet{display:none}}@media(max-width:640px)and (min-width:431px){.App:not(.is-web-component) .hide-in-mobile{display:none}}@container (max-width: 640px) and (min-width: 431px){.App.is-web-component .hide-in-mobile{display:none}}@media(max-width:430px){.App:not(.is-web-component) .hide-in-small-mobile{display:none}}@container (max-width: 430px){.App.is-web-component .hide-in-small-mobile{display:none}}.always-hide{display:none}.AnnotationPopup{position:absolute;z-index:70;display:flex;justify-content:center;align-items:center}.AnnotationPopup:empty{padding:0}.AnnotationPopup .buttons{display:flex}.AnnotationPopup .Button{margin:4px;width:32px;height:32px}@media(max-width:640px){.App:not(.is-in-desktop-only-mode):not(.is-web-component) .AnnotationPopup .Button{width:42px;height:42px}}@container (max-width: 640px){.App.is-web-component:not(.is-in-desktop-only-mode) .AnnotationPopup .Button{width:42px;height:42px}}.AnnotationPopup .Button:hover{background:var(--popup-button-hover)}.AnnotationPopup .Button .Icon{width:18px;height:18px}@media(max-width:640px){.App:not(.is-in-desktop-only-mode):not(.is-web-component) .AnnotationPopup .Button .Icon{width:24px;height:24px}}@container (max-width: 640px){.App.is-web-component:not(.is-in-desktop-only-mode) .AnnotationPopup .Button .Icon{width:24px;height:24px}}.is-vertical.AnnotationPopup .Button.main-menu-button{width:100%;border-radius:0;justify-content:flex-start;padding-left:var(--padding-small);padding-right:var(--padding-small);margin:0 0 var(--padding-tiny) 0}.is-vertical.AnnotationPopup .Button.main-menu-button:first-child{margin-top:var(--padding-tiny)}@media(max-width:640px){.App:not(.is-in-desktop-only-mode):not(.is-web-component) .is-vertical.AnnotationPopup .Button.main-menu-button{width:100%;height:32px}}@container (max-width: 640px){.App.is-web-component:not(.is-in-desktop-only-mode) .is-vertical.AnnotationPopup .Button.main-menu-button{width:100%;height:32px}}.is-vertical.AnnotationPopup .Button.main-menu-button .Icon{margin-right:10px}.is-vertical.AnnotationPopup .Button.main-menu-button span{white-space:nowrap}@-webkit-keyframes bottom-up{0%{transform:translateY(100%)}to{transform:translateY(0)}}@keyframes bottom-up{0%{transform:translateY(100%)}to{transform:translateY(0)}}@-webkit-keyframes up-bottom{0%{transform:translateY(0)}to{transform:translateY(100%)}}@keyframes up-bottom{0%{transform:translateY(0)}to{transform:translateY(100%)}}.AnnotationPopup{position:fixed;border-radius:4px;box-shadow:0 0 3px 0 var(--document-box-shadow);background:var(--component-background)}.AnnotationPopup.is-horizontal .container{display:inherit}.AnnotationPopup.is-vertical{flex-direction:column;align-items:flex-start}.shortCuts3D{position:relative}.shortCuts3D .closeButton{position:absolute;right:4px;padding:2px;cursor:pointer;width:20px;text-align:center}.shortCuts3D .row{padding:4px 0;margin:8px 26px 8px 16px}.shortCuts3D .row span{background:#e7ebee;padding:4px 8px;border-radius:4px}\", \"\"]);\n\n// exports\nexports.locals = {\n\t\"LEFT_HEADER_WIDTH\": \"41px\",\n\t\"RIGHT_HEADER_WIDTH\": \"41px\"\n};","import React, { useRef, useEffect } from 'react';\nimport PropTypes from 'prop-types';\n\nconst DatePicker = ({ onClick, annotation, onDatePickerShow }) => {\n  const dateRef = useRef(null);\n  const dateContainerRef = useRef(null);\n  useEffect(() => {\n    let datePicker;\n    const getDatePicker = async () => {\n      datePicker = await window.Core.createDatePicker({\n        field: dateRef.current,\n        onClick,\n        container: dateContainerRef.current,\n        format: annotation.getDateFormat(),\n      });\n      onDatePickerShow(true);\n    };\n    getDatePicker();\n\n    return () => {\n      datePicker.destroy();\n      datePicker = null;\n      onDatePickerShow(false);\n    };\n  }, []);\n  return (\n    <div data-element=\"datePickerContainer\">\n      <div ref={dateRef} />\n      <div ref={dateContainerRef}/>\n    </div>\n  );\n};\n\nDatePicker.propTypes = {\n  onClick: PropTypes.func.isRequired,\n  annotation: PropTypes.object.isRequired,\n  onDatePickerShow: PropTypes.func.isRequired\n};\n\nexport default DatePicker;\n","import DatePicker from './DatePicker';\n\nexport default DatePicker;","import React, { useState, useEffect, useRef } from 'react';\nimport selectors from 'selectors';\nimport { useSelector, useDispatch, shallowEqual } from 'react-redux';\nimport core from 'core';\nimport actions from 'actions';\nimport { Choice } from '@pdftron/webviewer-react-toolkit';\nimport Dropdown from '../Dropdown';\nimport Tooltip from '../Tooltip';\nimport PropTypes from 'prop-types';\nimport { useTranslation } from 'react-i18next';\nimport {\n  metricUnits,\n  convertUnit,\n  fractionalUnits,\n  floatRegex,\n  inFractionalRegex,\n  ftInFractionalRegex,\n  ftInDecimalRegex,\n  parseFtInDecimal,\n  parseInFractional,\n  parseFtInFractional,\n  hintValues\n} from 'constants/measurementScale';\nimport classNames from 'classnames';\n\nimport './CalibrationPopup.scss';\n\nconst Scale = window.Core.Scale;\n\nconst parseMeasurementContentsByAnnotation = (annotation) => {\n  const factor = annotation.Measure.axis[0].factor;\n  const unit = annotation.Scale[1][1];\n\n  switch (unit) {\n    case 'ft-in':\n      return (annotation.getLineLength() * factor) / 12;\n    case 'in':\n    default:\n      return annotation.getLineLength() * factor;\n  }\n};\n\nconst getDefaultPageUnit = (pageUnit) => {\n  if (pageUnit === 'pt') {\n    return 'pt';\n  }\n  if (metricUnits.includes(pageUnit)) {\n    return 'mm';\n  }\n  return 'in';\n};\n\nconst CalibrationPropType = {\n  annotation: PropTypes.shape({\n    Scale: PropTypes.arrayOf(PropTypes.array),\n  }),\n};\n\nconst CalibrationPopup = ({ annotation }) => {\n  const [t] = useTranslation();\n  const dispatch = useDispatch();\n\n  const [\n    measurementUnits,\n    { tempScale, isFractionalUnit, defaultUnit }\n  ] = useSelector((state) => [\n    selectors.getMeasurementUnits(state),\n    selectors.getCalibrationInfo(state)\n  ], shallowEqual);\n  const [valueDisplay, setValueDisplay] = useState('');\n  const inputRef = useRef(null);\n\n  const unitTo = new Scale(tempScale).worldScale?.unit || 'mm';\n  const unitToOptions = isFractionalUnit ? measurementUnits.to.filter((unit) => fractionalUnits.includes(unit)) : measurementUnits.to;\n  const isFractionalUnitsToggleDisabled = !fractionalUnits.includes(unitTo);\n  const valueInputType = (isFractionalUnit || unitTo === 'ft-in') ? 'text' : 'number';\n  const inputValueClass = classNames('input-field', {\n    'invalid-value': !(tempScale && new Scale(tempScale).worldScale?.value > 0)\n  });\n\n  const updateTempScale = (scaleValue, scaleUnit) => {\n    const currentDistance = parseMeasurementContentsByAnnotation(annotation);\n    const currentScale = annotation.Scale;\n    const newRatio = currentDistance / currentScale[1][0];\n    const pageScale = [currentScale[0][0] * newRatio, currentScale[0][1]];\n    const defaultPageUnit = getDefaultPageUnit(scaleUnit);\n    const defaultPageValue = convertUnit(pageScale[0], pageScale[1], defaultPageUnit);\n    dispatch(actions.updateCalibrationInfo({ tempScale: `${defaultPageValue} ${defaultPageUnit} = ${scaleValue} ${scaleUnit}`, isFractionalUnit }));\n  };\n\n  const setValue = (scaleValue) => {\n    updateTempScale(scaleValue, new Scale(tempScale).worldScale?.unit);\n  };\n\n  const setUnitTo = (scaleUnit) => {\n    updateTempScale(new Scale(tempScale).worldScale?.value, scaleUnit);\n  };\n\n  const toggleFractionalUnits = () => {\n    dispatch(actions.updateCalibrationInfo({ tempScale, isFractionalUnit: !isFractionalUnit }));\n  };\n\n  const onValueInputChange = (e) => {\n    setValueDisplay(e.target.value);\n    const inputValue = e.target.value.trim();\n    if (!isFractionalUnit) {\n      if (unitTo === 'ft-in' && ftInDecimalRegex.test(inputValue)) {\n        const result = parseFtInDecimal(inputValue);\n        if (result > 0) {\n          setValue(result);\n          return;\n        }\n      } else if (floatRegex.test(inputValue)) {\n        const result = parseFloat(inputValue) || 0;\n        setValue(result);\n        return;\n      }\n    } else {\n      if (unitTo === 'in') {\n        if (inFractionalRegex.test(inputValue)) {\n          const result = parseInFractional(inputValue);\n          if (result > 0) {\n            setValue(result);\n            return;\n          }\n        }\n      } else if (unitTo === 'ft-in') {\n        if (ftInFractionalRegex.test(inputValue)) {\n          const result = parseFtInFractional(inputValue);\n          if (result > 0) {\n            setValue(result);\n            return;\n          }\n        }\n      }\n    }\n    setValue(0);\n  };\n\n  const onValueInputBlur = () => {\n    updateValueDisplay();\n  };\n\n  const updateValueDisplay = () => {\n    const scaleValue = new Scale(tempScale).worldScale?.value;\n    let newValueDisplay;\n    if (!isFractionalUnit && unitTo !== 'ft-in') {\n      newValueDisplay = `${scaleValue}`;\n    } else {\n      newValueDisplay = Scale.getFormattedValue(scaleValue, unitTo, isFractionalUnit ? 1 / 64 : 0.0001, false, true);\n    }\n    setValueDisplay(newValueDisplay || '');\n  };\n\n  const tempScaleRef = useRef(tempScale);\n  useEffect(() => {\n    tempScaleRef.current = tempScale;\n  }, [tempScale]);\n  useEffect(() => {\n    if (annotation) {\n      const value = parseMeasurementContentsByAnnotation(annotation);\n      const unit = annotation.Scale[1][1];\n      if (defaultUnit) {\n        updateTempScale(convertUnit(value, unit, defaultUnit), defaultUnit);\n      } else {\n        updateTempScale(value, unit);\n      }\n    }\n\n    const onAnnotationChanged = (annotations, action) => {\n      if (action === 'modify' && annotations.length === 1 && annotations[0] === annotation) {\n        const value = parseMeasurementContentsByAnnotation(annotation);\n        const unit = annotation.Scale[1][1];\n        const currentUnit = new Scale(tempScaleRef.current).worldScale?.unit;\n        if (currentUnit) {\n          updateTempScale(convertUnit(value, unit, currentUnit), currentUnit);\n        } else {\n          updateTempScale(value, unit);\n        }\n      }\n    };\n    core.addEventListener('annotationChanged', onAnnotationChanged);\n\n    return () => {\n      core.removeEventListener('annotationChanged', onAnnotationChanged);\n      core.deleteAnnotations([annotation]);\n    };\n  }, [annotation]);\n\n  useEffect(() => {\n    if (inputRef?.current !== document.activeElement) {\n      updateValueDisplay();\n    }\n  }, [tempScale, isFractionalUnit]);\n\n  return (\n    <div className=\"CalibrationPopup\" data-element=\"calibrationPopup\">\n      <div className=\"input-container\">\n        <input\n          className={inputValueClass}\n          ref={inputRef}\n          type={valueInputType}\n          value={valueDisplay}\n          min='0'\n          onChange={onValueInputChange}\n          onBlur={onValueInputBlur}\n          placeholder={isFractionalUnit ? hintValues[unitTo] : (unitTo === 'ft-in' ? hintValues['ft-in decimal'] : '')}\n        />\n        <Tooltip content={'option.measurement.scaleModal.displayUnits'}>\n          <div className=\"input-field\">\n            <Dropdown\n              dataElement=\"calibrationUnits\"\n              items={unitToOptions}\n              currentSelectionKey={unitTo}\n              onClickItem={setUnitTo}\n            />\n          </div>\n        </Tooltip>\n      </div>\n      <Tooltip content={t('option.measurement.scaleModal.fractionUnitsTooltip')}>\n        <div>\n          <Choice\n            isSwitch\n            leftLabel\n            label={t('option.measurement.scaleModal.fractionalUnits')}\n            disabled={isFractionalUnitsToggleDisabled}\n            checked={isFractionalUnit}\n            id=\"calibration-popup-fractional-units\"\n            className=\"pop-switch\"\n            onChange={toggleFractionalUnits}\n          />\n        </div>\n      </Tooltip>\n    </div>\n  );\n};\n\nCalibrationPopup.propTypes = CalibrationPropType;\n\nexport default CalibrationPopup;\n","import CalibrationPopup from './CalibrationPopup';\n\nexport default CalibrationPopup;","import React, { useState } from 'react';\nimport Draggable from 'react-draggable';\nimport classNames from 'classnames';\nimport PropTypes from 'prop-types';\nimport { useTranslation } from 'react-i18next';\nimport { FocusTrap } from '@pdftron/webviewer-react-toolkit';\n\nimport ActionButton from 'components/ActionButton';\nimport AnnotationStylePopup from 'components/AnnotationStylePopup';\nimport DatePicker from 'components/DatePicker';\nimport CustomizablePopup from 'components/CustomizablePopup';\nimport CalibrationPopup from 'components/CalibrationPopup';\n\nimport { getDataWithKey, mapToolNameToKey, mapAnnotationToKey } from 'constants/map';\n\nimport DataElements from 'constants/dataElement';\n\nimport './AnnotationPopup.scss';\nimport getRootNode from 'helpers/getRootNode';\n\nconst propTypes = {\n  isMobile: PropTypes.bool,\n  isIE: PropTypes.bool,\n  isOpen: PropTypes.bool,\n  isRightClickMenu: PropTypes.bool,\n  isNotesPanelOpenOrActive: PropTypes.bool,\n  isRichTextPopupOpen: PropTypes.bool,\n  isLinkModalOpen: PropTypes.bool,\n\n  focusedAnnotation: PropTypes.object,\n  popupRef: PropTypes.any,\n  position: PropTypes.object,\n\n  showViewFileButton: PropTypes.bool,\n  onViewFile: PropTypes.func,\n\n  showCommentButton: PropTypes.bool,\n  onCommentAnnotation: PropTypes.func,\n  isDateFreeTextCanEdit: PropTypes.bool,\n  isDatePickerOpen: PropTypes.bool,\n  handleDateChange: PropTypes.func,\n  onDatePickerShow: PropTypes.func,\n  isCalibrationPopupOpen: PropTypes.bool,\n\n  showEditStyleButton: PropTypes.bool,\n  isStylePopupOpen: PropTypes.bool,\n  hideSnapModeCheckbox: PropTypes.bool,\n  openEditStylePopup: PropTypes.func,\n  closeEditStylePopup: PropTypes.func,\n  annotationStyle: PropTypes.object,\n  onResize: PropTypes.func,\n\n  showContentEditButton: PropTypes.bool,\n  onEditContent: PropTypes.func,\n  openContentEditDeleteWarningModal: PropTypes.func,\n\n  isAppearanceSignature: PropTypes.bool,\n  onClearAppearanceSignature: PropTypes.func,\n\n  showRedactionButton: PropTypes.bool,\n  onApplyRedaction: PropTypes.func,\n\n  showGroupButton: PropTypes.bool,\n  onGroupAnnotations: PropTypes.func,\n  showUngroupButton: PropTypes.bool,\n  onUngroupAnnotations: PropTypes.func,\n\n  showFormFieldButton: PropTypes.bool,\n  onOpenFormField: PropTypes.func,\n\n  showDeleteButton: PropTypes.bool,\n  onDeleteAnnotation: PropTypes.func,\n\n  showLinkButton: PropTypes.bool,\n  hasAssociatedLink: PropTypes.bool,\n  linkAnnotationToURL: PropTypes.func,\n\n  showFileDownloadButton: PropTypes.bool,\n  downloadFileAttachment: PropTypes.func,\n\n  showAudioPlayButton: PropTypes.bool,\n  handlePlaySound: PropTypes.func,\n\n  showCalibrateButton: PropTypes.bool,\n  onOpenCalibration: PropTypes.func,\n};\n\nconst AnnotationPopup = ({\n  isMobile,\n  isIE,\n  isOpen,\n  isRightClickMenu,\n  isNotesPanelOpenOrActive,\n  isRichTextPopupOpen,\n  isLinkModalOpen,\n\n  focusedAnnotation,\n  popupRef,\n  position,\n\n  showViewFileButton,\n  onViewFile,\n\n  showCommentButton,\n  onCommentAnnotation,\n  isDateFreeTextCanEdit,\n  isDatePickerOpen,\n  handleDateChange,\n  onDatePickerShow,\n  isCalibrationPopupOpen,\n\n  showEditStyleButton,\n  isStylePopupOpen,\n  hideSnapModeCheckbox,\n  openEditStylePopup,\n  closeEditStylePopup,\n  annotationStyle,\n  onResize,\n\n  showContentEditButton,\n  onEditContent,\n  openContentEditDeleteWarningModal,\n\n  isAppearanceSignature,\n  onClearAppearanceSignature,\n\n  showRedactionButton,\n  onApplyRedaction,\n\n  showGroupButton,\n  onGroupAnnotations,\n  showUngroupButton,\n  onUngroupAnnotations,\n\n  showFormFieldButton,\n  onOpenFormField,\n\n  showDeleteButton,\n  onDeleteAnnotation,\n\n  showLinkButton,\n  hasAssociatedLink,\n  linkAnnotationToURL,\n\n  showFileDownloadButton,\n  downloadFileAttachment,\n\n  showAudioPlayButton,\n  handlePlaySound,\n\n  showCalibrateButton,\n  onOpenCalibration,\n}) => {\n  const [t] = useTranslation();\n  const [shortCutKeysFor3DVisible, setShortCutKeysFor3DVisible] = useState(false);\n\n  const commentButtonLabel = isDateFreeTextCanEdit ? 'action.changeDate' : 'action.comment';\n  const commentButtonImg = isDateFreeTextCanEdit ? 'icon-tool-fill-and-sign-calendar' : 'icon-header-chat-line';\n\n  const show3DShortCutButton = focusedAnnotation instanceof window.Core.Annotations.Model3DAnnotation && !isMobile;\n  const isRectangle = focusedAnnotation instanceof window.Core.Annotations.RectangleAnnotation;\n  const isEllipse = focusedAnnotation instanceof window.Core.Annotations.EllipseAnnotation;\n  const isPolygon = focusedAnnotation instanceof window.Core.Annotations.PolygonAnnotation;\n  const isFreeText =\n    focusedAnnotation instanceof window.Core.Annotations.FreeTextAnnotation &&\n    (focusedAnnotation.getIntent() === window.Core.Annotations.FreeTextAnnotation.Intent.FreeText ||\n      focusedAnnotation.getIntent() === window.Core.Annotations.FreeTextAnnotation.Intent.FreeTextCallout);\n  const isRedaction = focusedAnnotation instanceof window.Core.Annotations.RedactionAnnotation;\n  const colorMapKey = mapAnnotationToKey(focusedAnnotation);\n  const isMeasure = !!focusedAnnotation.Measure;\n  const showLineStyleOptions = getDataWithKey(mapToolNameToKey(focusedAnnotation.ToolName)).hasLineEndings;\n  const isInstanceActive = !window.isApryseWebViewerWebComponent || document.activeElement?.shadowRoot === getRootNode();\n  let StrokeStyle = 'solid';\n  const isContentEdit = focusedAnnotation.isContentEditPlaceholder?.();\n\n  try {\n    StrokeStyle = (focusedAnnotation['Style'] === 'dash')\n      ? `${focusedAnnotation['Style']},${focusedAnnotation['Dashes']}`\n      : focusedAnnotation['Style'];\n  } catch (err) {\n    console.error(err);\n  }\n  let properties = {};\n  if (showLineStyleOptions) {\n    properties = {\n      StartLineStyle: focusedAnnotation.getStartStyle(),\n      EndLineStyle: focusedAnnotation.getEndStyle(),\n      StrokeStyle,\n    };\n  }\n\n  if (isRectangle || isEllipse || isPolygon) {\n    properties = {\n      StrokeStyle,\n    };\n  }\n\n  if (isFreeText) {\n    const richTextStyles = focusedAnnotation.getRichTextStyle();\n    properties = {\n      Font: focusedAnnotation.Font,\n      FontSize: focusedAnnotation.FontSize,\n      TextAlign: focusedAnnotation.TextAlign,\n      TextVerticalAlign: focusedAnnotation.TextVerticalAlign,\n      bold: richTextStyles?.[0]?.['font-weight'] === 'bold' ?? false,\n      italic: richTextStyles?.[0]?.['font-style'] === 'italic' ?? false,\n      underline: richTextStyles?.[0]?.['text-decoration']?.includes('underline') || richTextStyles?.[0]?.['text-decoration']?.includes('word'),\n      strikeout: richTextStyles?.[0]?.['text-decoration']?.includes('line-through') ?? false,\n      StrokeStyle,\n    };\n  }\n\n  if (isRedaction) {\n    properties = {\n      OverlayText: focusedAnnotation['OverlayText'],\n      Font: focusedAnnotation['Font'],\n      FontSize: focusedAnnotation['FontSize'],\n      TextAlign: focusedAnnotation['TextAlign']\n    };\n  }\n\n  const renderPopup = () => {\n    switch (true) {\n      case isStylePopupOpen:\n        return (\n          <AnnotationStylePopup\n            annotations={[focusedAnnotation]}\n            style={annotationStyle}\n            isOpen={isOpen}\n            onResize={onResize}\n            isFreeText={isFreeText}\n            isEllipse={isEllipse}\n            isRedaction={isRedaction}\n            isMeasure={isMeasure}\n            colorMapKey={colorMapKey}\n            showLineStyleOptions={showLineStyleOptions}\n            properties={properties}\n            hideSnapModeCheckbox={hideSnapModeCheckbox}\n            hasBackToMenu={isRightClickMenu}\n            onBackToMenu={closeEditStylePopup}\n          />\n        );\n      case isDatePickerOpen:\n        return (\n          <DatePicker onClick={handleDateChange} annotation={focusedAnnotation} onDatePickerShow={onDatePickerShow} />\n        );\n      case isCalibrationPopupOpen:\n        return <CalibrationPopup annotation={focusedAnnotation} />;\n      case shortCutKeysFor3DVisible && focusedAnnotation instanceof window.Core.Annotations.Model3DAnnotation:\n        return (\n          <div className=\"shortCuts3D\">\n            <div className=\"closeButton\" onClick={() => setShortCutKeysFor3DVisible(false)}>x</div>\n            <div className=\"row\">{t('action.rotate3D')} <span>{t('shortcut.rotate3D')}</span></div>\n            <div className=\"row\">{t('action.zoom')} <span>{t('shortcut.zoom3D')}</span></div>\n          </div>\n        );\n      default:\n        return (\n          <FocusTrap\n            locked={isOpen && isInstanceActive && !isRichTextPopupOpen && !isNotesPanelOpenOrActive && !isLinkModalOpen && !isFreeText}\n          >\n            <div className=\"container\">\n              <CustomizablePopup\n                dataElement={DataElements.ANNOTATION_POPUP}\n                childrenClassName='main-menu-button'\n              >\n                {showViewFileButton && (\n                  <ActionButton\n                    className=\"main-menu-button\"\n                    dataElement=\"viewFileButton\"\n                    label={isRightClickMenu ? 'action.viewFile' : ''}\n                    title={!isRightClickMenu ? 'action.viewFile' : ''}\n                    img=\"icon-view\"\n                    onClick={onViewFile}\n                  />\n                )}\n                {showCommentButton && (\n                  <ActionButton\n                    className=\"main-menu-button\"\n                    dataElement=\"annotationCommentButton\"\n                    label={isRightClickMenu ? commentButtonLabel : ''}\n                    title={!isRightClickMenu ? commentButtonLabel : ''}\n                    img={commentButtonImg}\n                    onClick={onCommentAnnotation}\n                  />\n                )}\n                {showEditStyleButton && (\n                  <ActionButton\n                    className=\"main-menu-button\"\n                    dataElement=\"annotationStyleEditButton\"\n                    label={isRightClickMenu ? 'action.style' : ''}\n                    title={!isRightClickMenu ? 'action.style' : ''}\n                    img=\"icon-menu-style-line\"\n                    onClick={openEditStylePopup}\n                  />\n                )}\n                {showContentEditButton && (\n                  <ActionButton\n                    className=\"main-menu-button\"\n                    dataElement=\"annotationContentEditButton\"\n                    label={isRightClickMenu ? 'action.edit' : ''}\n                    title={!isRightClickMenu ? 'action.edit' : ''}\n                    img=\"ic_edit_page_24px\"\n                    onClick={onEditContent}\n                  />\n                )}\n                {isAppearanceSignature && (\n                  <ActionButton\n                    className=\"main-menu-button\"\n                    dataElement=\"annotationClearSignatureButton\"\n                    label={isRightClickMenu ? 'action.clearSignature' : ''}\n                    title={!isRightClickMenu ? 'action.clearSignature' : ''}\n                    img=\"icon-delete-line\"\n                    onClick={onClearAppearanceSignature}\n                  />\n                )}\n                {showRedactionButton && (\n                  <ActionButton\n                    className=\"main-menu-button\"\n                    dataElement=\"annotationRedactButton\"\n                    label={isRightClickMenu ? 'action.apply' : ''}\n                    title={!isRightClickMenu ? 'action.apply' : ''}\n                    img=\"ic_check_black_24px\"\n                    onClick={onApplyRedaction}\n                  />\n                )}\n                {showGroupButton && (\n                  <ActionButton\n                    className=\"main-menu-button\"\n                    dataElement=\"annotationGroupButton\"\n                    label={isRightClickMenu ? 'action.group' : ''}\n                    title={!isRightClickMenu ? 'action.group' : ''}\n                    img=\"group-annotations-icon\"\n                    onClick={onGroupAnnotations}\n                  />\n                )}\n                {showUngroupButton && (\n                  <ActionButton\n                    className=\"main-menu-button\"\n                    dataElement=\"annotationUngroupButton\"\n                    label={isRightClickMenu ? 'action.ungroup' : ''}\n                    title={!isRightClickMenu ? 'action.ungroup' : ''}\n                    img=\"ungroup-annotations-icon\"\n                    onClick={onUngroupAnnotations}\n                  />\n                )}\n                {showFormFieldButton && (\n                  <ActionButton\n                    className=\"main-menu-button\"\n                    dataElement=\"formFieldEditButton\"\n                    label={isRightClickMenu ? 'action.formFieldEdit' : ''}\n                    title={!isRightClickMenu ? 'action.formFieldEdit' : ''}\n                    img=\"icon-edit-form-field\"\n                    onClick={onOpenFormField}\n                  />\n                )}\n                {showDeleteButton && (\n                  <ActionButton\n                    className=\"main-menu-button\"\n                    dataElement=\"annotationDeleteButton\"\n                    label={isRightClickMenu ? 'action.delete' : ''}\n                    title={!isRightClickMenu ? 'action.delete' : ''}\n                    img=\"icon-delete-line\"\n                    onClick={isContentEdit ? openContentEditDeleteWarningModal : onDeleteAnnotation}\n                  />\n                )}\n                {showCalibrateButton && (\n                  <ActionButton\n                    className=\"main-menu-button\"\n                    dataElement={DataElements.CALIBRATION_POPUP_BUTTON}\n                    label={isRightClickMenu ? 'action.calibrate' : ''}\n                    title={!isRightClickMenu ? 'action.calibrate' : ''}\n                    img=\"calibrate\"\n                    onClick={onOpenCalibration}\n                  />\n                )}\n                {showLinkButton && (\n                  <ActionButton\n                    className=\"main-menu-button\"\n                    dataElement=\"linkButton\"\n                    label={isRightClickMenu ? 'tool.Link' : ''}\n                    title={!isRightClickMenu ? 'tool.Link' : ''}\n                    img={hasAssociatedLink ? 'icon-tool-unlink' : 'icon-tool-link'}\n                    onClick={linkAnnotationToURL}\n                  />\n                )}\n                {showFileDownloadButton && (\n                  <ActionButton\n                    className=\"main-menu-button\"\n                    dataElement=\"fileAttachmentDownload\"\n                    label={isRightClickMenu ? 'action.fileAttachmentDownload' : ''}\n                    title={!isRightClickMenu ? 'action.fileAttachmentDownload' : ''}\n                    img=\"icon-download\"\n                    onClick={() => downloadFileAttachment(focusedAnnotation)}\n                  />\n                )}\n                {show3DShortCutButton && (\n                  <ActionButton\n                    className=\"main-menu-button\"\n                    dataElement=\"shortCutKeysFor3D\"\n                    label={isRightClickMenu ? 'action.viewShortCutKeysFor3D' : ''}\n                    title={!isRightClickMenu ? 'action.viewShortCutKeysFor3D' : ''}\n                    img=\"icon-keyboard\"\n                    onClick={() => setShortCutKeysFor3DVisible(true)}\n                  />\n                )}\n                {showAudioPlayButton && (\n                  <ActionButton\n                    className=\"main-menu-button\"\n                    dataElement=\"playSoundButton\"\n                    label={isRightClickMenu ? 'action.playAudio' : ''}\n                    title={!isRightClickMenu ? 'action.playAudio' : ''}\n                    img=\"ic_play_24px\"\n                    onClick={() => handlePlaySound(focusedAnnotation)}\n                  />\n                )}\n              </CustomizablePopup>\n            </div>\n          </FocusTrap>\n        );\n    }\n  };\n\n  const annotationPopup = (\n    <div\n      className={classNames({\n        Popup: true,\n        AnnotationPopup: true,\n        open: isOpen,\n        closed: !isOpen,\n        stylePopupOpen: isStylePopupOpen,\n        'is-vertical': isRightClickMenu,\n        'is-horizontal': !isRightClickMenu,\n      })}\n      ref={popupRef}\n      data-element={DataElements.ANNOTATION_POPUP}\n      style={{ ...position }}\n    >\n      {renderPopup()}\n    </div>\n  );\n\n  return isIE || isMobile ? (\n    annotationPopup\n  ) : (\n    <Draggable cancel=\".Button, .cell, .sliders-container svg, select, button, input\">{annotationPopup}</Draggable>\n  );\n};\n\nAnnotationPopup.propTypes = propTypes;\n\nexport default AnnotationPopup;\n","import React, { useState, useEffect, useRef, useCallback, memo, useLayoutEffect } from 'react';\nimport { useSelector, useDispatch, shallowEqual } from 'react-redux';\nimport PropTypes from 'prop-types';\n\nimport core from 'core';\nimport { getAnnotationPopupPositionBasedOn } from 'helpers/getPopupPosition';\nimport getAnnotationStyles from 'helpers/getAnnotationStyles';\nimport applyRedactions from 'helpers/applyRedactions';\nimport { isMobile, isIE } from 'helpers/device';\nimport { useTranslation } from 'react-i18next';\nimport { getOpenedWarningModal, getOpenedColorPicker, getDatePicker } from 'helpers/getElements';\nimport getGroupedLinkAnnotations from 'helpers/getGroupedLinkAnnotations';\nimport getHashParameters from 'helpers/getHashParameters';\nimport useOnClickOutside from 'hooks/useOnClickOutside';\nimport actions from 'actions';\nimport selectors from 'selectors';\nimport DataElements from 'constants/dataElement';\nimport { PRIORITY_THREE } from 'constants/actionPriority';\nimport getRootNode from 'helpers/getRootNode';\n\nimport AnnotationPopup from './AnnotationPopup';\nimport './AnnotationPopup.scss';\n\nconst { ToolNames } = window.Core.Tools;\nconst { Annotations } = window.Core;\n\nconst propTypes = {\n  focusedAnnotation: PropTypes.object,\n  selectedMultipleAnnotations: PropTypes.bool,\n  canModify: PropTypes.bool,\n  isStylePopupOpen: PropTypes.bool,\n  setIsStylePopupOpen: PropTypes.func,\n  isDatePickerOpen: PropTypes.bool,\n  setDatePickerOpen: PropTypes.func,\n  isDatePickerMount: PropTypes.bool,\n  setDatePickerMount: PropTypes.func,\n  hasAssociatedLink: PropTypes.bool,\n  includesFormFieldAnnotation: PropTypes.bool,\n  stylePopupRepositionFlag: PropTypes.bool,\n  setStylePopupRepositionFlag: PropTypes.func,\n  closePopup: PropTypes.func,\n};\n\nconst AnnotationPopupContainer = ({\n  focusedAnnotation,\n  selectedMultipleAnnotations,\n  canModify,\n  isStylePopupOpen,\n  setIsStylePopupOpen,\n  isDatePickerOpen,\n  setDatePickerOpen,\n  isDatePickerMount,\n  setDatePickerMount,\n  hasAssociatedLink,\n  includesFormFieldAnnotation,\n  stylePopupRepositionFlag,\n  setStylePopupRepositionFlag,\n  closePopup,\n}) => {\n  const [\n    isDisabled,\n    isOpen,\n    isRightClickAnnotationPopupEnabled,\n    isNotesPanelDisabled,\n    isAnnotationStylePopupDisabled,\n    isInlineCommentingDisabled,\n    isNotesPanelOpen,\n    isLinkModalOpen,\n    isRichTextPopupOpen,\n    isMultiTab,\n    tabManager,\n    tabs,\n    notesInLeftPanel,\n    leftPanelOpen,\n    activeLeftPanel,\n  ] = useSelector(\n    (state) => [\n      selectors.isElementDisabled(state, DataElements.ANNOTATION_POPUP),\n      selectors.isElementOpen(state, DataElements.ANNOTATION_POPUP),\n      selectors.isRightClickAnnotationPopupEnabled(state),\n      selectors.isElementDisabled(state, DataElements.NOTES_PANEL),\n      selectors.isElementDisabled(state, DataElements.ANNOTATION_STYLE_POPUP),\n      selectors.isElementDisabled(state, DataElements.INLINE_COMMENT_POPUP),\n      selectors.isElementOpen(state, DataElements.NOTES_PANEL),\n      selectors.isElementOpen(state, DataElements.LINK_MODAL),\n      selectors.isElementOpen(state, 'richTextPopup'),\n      selectors.getIsMultiTab(state),\n      selectors.getTabManager(state),\n      selectors.getTabs(state),\n      selectors.getNotesInLeftPanel(state),\n      selectors.isElementOpen(state, DataElements.LEFT_PANEL),\n      selectors.getActiveLeftPanel(state),\n    ],\n    shallowEqual,\n  );\n  const [t] = useTranslation();\n  const dispatch = useDispatch();\n  const [position, setPosition] = useState({ left: 0, top: 0 });\n  const [isCalibrationPopupOpen, setCalibrationPopupOpen] = useState(false);\n  const popupRef = useRef();\n\n  const isFocusedAnnotationSelected = isRightClickAnnotationPopupEnabled ? core.isAnnotationSelected(focusedAnnotation) : true;\n  const annotManager = core.getAnnotationManager();\n  const isNotesPanelOpenOrActive = isNotesPanelOpen || (notesInLeftPanel && leftPanelOpen && activeLeftPanel === 'notesPanel');\n  // on tablet, the behaviour will be like on desktop, including being draggable\n\n  useOnClickOutside(\n    popupRef,\n    useCallback((e) => {\n      const notesPanel = getRootNode().querySelector(`[data-element=\"${DataElements.NOTES_PANEL}\"]`);\n      const clickedInNotesPanel = notesPanel?.contains(e.target);\n      const clickedInLinkModal = getRootNode().querySelector('.LinkModal.open')?.contains(e.target);\n      const datePicker = getDatePicker();\n      const warningModal = getOpenedWarningModal();\n      const colorPicker = getOpenedColorPicker();\n\n      // the notes panel has mousedown handlers to handle the opening/closing states of this component\n      // we don't want this handler to run when clicked in the notes panel otherwise the opening/closing states may mess up\n      // for example: click on a note will call core.selectAnnotation which triggers the annotationSelected event\n      // and opens this component. If we don't exclude the notes panel this handler will run and close it after\n      if (!clickedInNotesPanel && !clickedInLinkModal && !warningModal && !colorPicker && !datePicker) {\n        if (isRightClickAnnotationPopupEnabled) {\n          closePopup();\n        } else {\n          dispatch(actions.closeElement(DataElements.ANNOTATION_POPUP));\n        }\n      }\n    }, [isRightClickAnnotationPopupEnabled])\n  );\n\n  const setPopupPosition = () => {\n    if (popupRef.current) {\n      setPosition(getAnnotationPopupPositionBasedOn(focusedAnnotation, popupRef));\n    }\n  };\n\n  // useLayoutEffect here to avoid flashing issue when popup is close and open on scroll\n  useLayoutEffect(() => {\n    if (focusedAnnotation || isStylePopupOpen || isDatePickerMount) {\n      setPopupPosition();\n    }\n    // canModify is needed here because the effect from useOnAnnotationPopupOpen hook will run again and determine which button to show, which in turn change the popup size and will need to recalculate position\n  }, [focusedAnnotation, isStylePopupOpen, isDatePickerMount, canModify]);\n\n\n  useEffect(() => {\n    if (focusedAnnotation && focusedAnnotation.ToolName === ToolNames.CALIBRATION_MEASUREMENT) {\n      setCalibrationPopupOpen(true);\n    }\n  }, [focusedAnnotation]);\n\n  useEffect(() => {\n    if (isOpen || isRichTextPopupOpen) {\n      dispatch(actions.closeElement(DataElements.INLINE_COMMENT_POPUP));\n    }\n  }, [isOpen, isRichTextPopupOpen]);\n\n  /* VIEW FILE */\n  const wvServer = !!getHashParameters('webviewerServerURL', null);\n  const acceptFormats = wvServer ? window.Core.SupportedFileFormats.SERVER : window.Core.SupportedFileFormats.CLIENT;\n  const showViewFileButton = focusedAnnotation instanceof Annotations.FileAttachmentAnnotation && isMultiTab\n    && acceptFormats.includes(window.Core.mimeTypeToExtension[focusedAnnotation.getFileMetadata().mimeType]);\n\n  const onViewFile = useCallback(async () => {\n    if (!tabManager || !isMultiTab) {\n      return console.warn('Can\\'t open file in non-multi-tab mode');\n    }\n    const metaData = focusedAnnotation.getFileMetadata();\n    const fileAttachmentTab = tabs.find((tab) => tab.options.filename === metaData.filename);\n    if (fileAttachmentTab) { // If already opened once\n      await tabManager.setActiveTab(fileAttachmentTab.id, true);\n      return;\n    }\n    await tabManager.addTab(await focusedAnnotation.getFileData(), {\n      extension: window.Core.mimeTypeToExtension[metaData.mimeType],\n      filename: metaData.filename,\n      saveCurrentActiveTabState: true,\n      setActive: true,\n    });\n  }, [tabManager, focusedAnnotation, tabs, isMultiTab]);\n\n  /* ALL REACT HOOKS NEED TO BE BEFORE RENDERING */\n  if (isDisabled || !focusedAnnotation) {\n    return null;\n  }\n\n  /* COMMENT / DATE */\n  const selectedAnnotations = core.getSelectedAnnotations();\n  const numberOfSelectedAnnotations = selectedAnnotations.length;\n  const multipleAnnotationsSelected = numberOfSelectedAnnotations > 1;\n  const isFreeTextAnnot = focusedAnnotation instanceof Annotations.FreeTextAnnotation;\n  const isDateFreeTextCanEdit = isFreeTextAnnot && !!focusedAnnotation.getDateFormat() && core.canModifyContents(focusedAnnotation);\n  const numberOfGroups = core.getNumberOfGroups(selectedAnnotations);\n  const canGroup = numberOfGroups > 1;\n  const canUngroup = numberOfGroups === 1 && numberOfSelectedAnnotations > 1 && isFocusedAnnotationSelected;\n  const isAppearanceSignature =\n    focusedAnnotation instanceof Annotations.SignatureWidgetAnnotation\n    && focusedAnnotation.isSignedByAppearance();\n\n  const showCommentButton = (\n    (!isNotesPanelDisabled || !isInlineCommentingDisabled)\n    && (!multipleAnnotationsSelected || (multipleAnnotationsSelected && !isFocusedAnnotationSelected))\n    && focusedAnnotation.ToolName !== ToolNames.CROP\n    && !includesFormFieldAnnotation\n    && !focusedAnnotation.isContentEditPlaceholder()\n    && !focusedAnnotation.isUncommittedContentEditPlaceholder()\n    && !isAppearanceSignature\n  );\n\n  const onCommentAnnotation = () => {\n    if (isDateFreeTextCanEdit) {\n      setDatePickerOpen(true);\n      return;\n    }\n\n    dispatch(actions.closeElement('searchPanel'));\n    dispatch(actions.closeElement('redactionPanel'));\n    const contentEditManager = core.getContentEditManager();\n    if (contentEditManager.isInContentEditMode()) {\n      dispatch(actions.closeElement('textEditingPanel'));\n      contentEditManager.endContentEditMode();\n    }\n\n    dispatch(actions.triggerNoteEditing());\n    if (isInlineCommentingDisabled) {\n      dispatch(actions.openElement(DataElements.NOTES_PANEL));\n      dispatch(actions.closeElement(DataElements.ANNOTATION_POPUP));\n    } else {\n      if (!isNotesPanelOpen) {\n        dispatch(actions.openElement(DataElements.INLINE_COMMENT_POPUP));\n      }\n      closePopup();\n    }\n  };\n\n  const handleDateChange = (text) => {\n    annotManager.setNoteContents(focusedAnnotation, text);\n    annotManager.updateAnnotation(focusedAnnotation);\n  };\n\n  const onDatePickerShow = (isDatePickerShowed) => {\n    setDatePickerMount(isDatePickerShowed);\n  };\n\n  /* EDIT STYLE */\n  const annotationStyle = getAnnotationStyles(focusedAnnotation);\n  const hasStyle = Object.keys(annotationStyle).length > 0;\n\n  const toolsWithNoStyling = [\n    ToolNames.CROP,\n    ToolNames.RADIO_FORM_FIELD,\n    ToolNames.CHECK_BOX_FIELD,\n    ToolNames.VIDEO_REDACTION,\n    ToolNames.VIDEO_AND_AUDIO_REDACTION,\n    ToolNames.AUDIO_REDACTION,\n  ];\n\n  const showEditStyleButton = (\n    canModify\n    && hasStyle\n    && !isAnnotationStylePopupDisabled\n    && (!multipleAnnotationsSelected || canUngroup || (multipleAnnotationsSelected && !isFocusedAnnotationSelected))\n    && !toolsWithNoStyling.includes(focusedAnnotation.ToolName)\n    && !(focusedAnnotation instanceof Annotations.Model3DAnnotation)\n    && !focusedAnnotation.isContentEditPlaceholder()\n    && !focusedAnnotation.isUncommittedContentEditPlaceholder()\n    && !isAppearanceSignature\n  );\n\n  const hideSnapModeCheckbox = focusedAnnotation instanceof Annotations.EllipseAnnotation || !core.isFullPDFEnabled();\n\n  const onResize = () => {\n    setStylePopupRepositionFlag(!stylePopupRepositionFlag);\n  };\n\n  /* EDIT CONTENT */\n  const showContentEditButton =\n    focusedAnnotation.isContentEditPlaceholder()\n    && focusedAnnotation.getContentEditType() === window.Core.ContentEdit.Types.TEXT;\n\n  const onEditContent = async () => {\n    // TODO: remove this from the state and nuke the modal\n    if (isMobile()) {\n      const content = await window.Core.ContentEdit.getDocumentContent(focusedAnnotation);\n      dispatch(actions.setCurrentContentBeingEdited({ content, annotation: focusedAnnotation }));\n      dispatch(actions.openElement(DataElements.CONTENT_EDIT_MODAL));\n    } else {\n      annotManager.trigger('annotationDoubleClicked', focusedAnnotation);\n    }\n    dispatch(actions.closeElement(DataElements.ANNOTATION_POPUP));\n  };\n\n  /* CLEAR APPEARANCE SIGNATURE */\n  const onClearAppearanceSignature = () => {\n    focusedAnnotation.clearSignature(annotManager);\n    dispatch(actions.closeElement(DataElements.ANNOTATION_POPUP));\n  };\n\n  /* REDACTION */\n  const redactionEnabled = core.isAnnotationRedactable(focusedAnnotation);\n  const showRedactionButton = redactionEnabled && !multipleAnnotationsSelected && !includesFormFieldAnnotation;\n\n  const onApplyRedaction = () => {\n    dispatch(applyRedactions(focusedAnnotation));\n    dispatch(actions.closeElement(DataElements.ANNOTATION_POPUP));\n  };\n\n  /* GROUP / UNGROUP */\n  const primaryAnnotation = selectedAnnotations.find((selectedAnnotation) => !selectedAnnotation.InReplyTo);\n\n  const showGroupButton =\n    isFocusedAnnotationSelected\n    && canGroup\n    && !includesFormFieldAnnotation;\n\n  const onGroupAnnotations = () => {\n    core.groupAnnotations(primaryAnnotation, selectedAnnotations);\n  };\n\n  const showUngroupButton = canUngroup;\n\n  const onUngroupAnnotations = () => {\n    core.ungroupAnnotations(selectedAnnotations);\n  };\n\n  /* FORM FIELD */\n  const formFieldCreationManager = core.getFormFieldCreationManager();\n  const isInFormFieldCreationMode = formFieldCreationManager.isInFormFieldCreationMode();\n  const showFormFieldButton = includesFormFieldAnnotation && isInFormFieldCreationMode;\n\n  const onOpenFormField = () => {\n    closePopup();\n    // We disable it while the form field popup is open to prevent having both open\n    // at the same time. We re-enable it when the form field popup is closed.\n    dispatch(actions.disableElement(DataElements.ANNOTATION_POPUP, PRIORITY_THREE));\n    dispatch(actions.openElement(DataElements.FORM_FIELD_EDIT_POPUP));\n  };\n\n  /* DELETE ANNOTATION */\n  const showDeleteButton = canModify;\n\n  const openContentEditDeleteWarningModal = () => {\n    const message = t('option.contentEdit.deletionModal.message');\n    const title = t('option.contentEdit.deletionModal.title');\n    const confirmBtnText = t('action.ok');\n\n    const warning = {\n      message,\n      title,\n      confirmBtnText,\n      onConfirm: () => onDeleteAnnotation(),\n    };\n    dispatch(actions.showWarningMessage(warning));\n  };\n\n  const onDeleteAnnotation = () => {\n    if (isFocusedAnnotationSelected) {\n      core.deleteAnnotations(core.getSelectedAnnotations());\n    } else {\n      core.deleteAnnotations([focusedAnnotation]);\n    }\n    closePopup();\n  };\n\n  /* LINK ANNOTATION */\n  const toolsThatCantHaveLinks = [\n    ToolNames.CROP,\n    ToolNames.SIGNATURE,\n    ToolNames.REDACTION,\n    ToolNames.REDACTION2,\n    ToolNames.REDACTION3,\n    ToolNames.REDACTION4,\n    ToolNames.STICKY,\n    ToolNames.STICKY2,\n    ToolNames.STICKY3,\n    ToolNames.STICKY4,\n  ];\n\n  const showLinkButton = (\n    !toolsThatCantHaveLinks.includes(focusedAnnotation.ToolName)\n    && !includesFormFieldAnnotation\n    && !focusedAnnotation.isContentEditPlaceholder()\n    // TODO(Adam): Update this once SoundAnnotation tool is created.\n    && !(focusedAnnotation instanceof Annotations.SoundAnnotation)\n    && !focusedAnnotation.isUncommittedContentEditPlaceholder()\n    && !isAppearanceSignature\n  );\n\n  const showCalibrateButton =\n    canModify\n    && focusedAnnotation.Measure\n    && focusedAnnotation instanceof Annotations.LineAnnotation;\n\n  const onOpenCalibration = () => {\n    dispatch(actions.closeElement(DataElements.ANNOTATION_POPUP));\n    dispatch(actions.openElement(DataElements.CALIBRATION_MODAL));\n  };\n\n  const linkAnnotationToURL = () => {\n    if (hasAssociatedLink) {\n      const annotationsToUnlink = isFocusedAnnotationSelected ? selectedAnnotations : [focusedAnnotation];\n      annotationsToUnlink.forEach((annot) => {\n        const linkAnnotations = getGroupedLinkAnnotations(annot);\n        linkAnnotations.forEach((linkAnnot, index) => {\n          annotManager.ungroupAnnotations([linkAnnot]);\n          if (annot instanceof Annotations.TextHighlightAnnotation && annot.Opacity === 0 && index === 0) {\n            annotManager.deleteAnnotations([annot, linkAnnot], null, true);\n          } else {\n            annotManager.deleteAnnotation(linkAnnot, null, true);\n          }\n        });\n      });\n      closePopup();\n    } else {\n      dispatch(actions.openElement(DataElements.LINK_MODAL));\n    }\n  };\n\n  /* DOWNLOAD FILE ATTACHMENT */\n  const showFileDownloadButton = focusedAnnotation instanceof Annotations.FileAttachmentAnnotation;\n\n  const downloadFileAttachment = (annot) => {\n    // no need to check that annot is of type file annot as the check is done in the JSX\n    // trigger the annotationDoubleClicked event so that it will download the file\n    annotManager.trigger('annotationDoubleClicked', annot);\n  };\n\n  /* AUDIO ANNOTATION */\n  const showAudioPlayButton = (\n    !isIE &&\n    !selectedMultipleAnnotations &&\n    focusedAnnotation instanceof Annotations.SoundAnnotation &&\n    focusedAnnotation.hasAudioData()\n  );\n\n  const handlePlaySound = (annotation) => {\n    dispatch(actions.setActiveSoundAnnotation(annotation));\n    dispatch(actions.triggerResetAudioPlaybackPosition(true));\n    dispatch(actions.openElement('audioPlaybackPopup'));\n  };\n\n  return (\n    <AnnotationPopup\n      isMobile={isMobile()}\n      isIE={isIE}\n      isOpen={isOpen}\n      isRightClickMenu={isRightClickAnnotationPopupEnabled}\n      isNotesPanelOpenOrActive={isNotesPanelOpenOrActive}\n      isRichTextPopupOpen={isRichTextPopupOpen}\n      isLinkModalOpen={isLinkModalOpen}\n\n      popupRef={popupRef}\n      position={position}\n      focusedAnnotation={focusedAnnotation}\n\n      showViewFileButton={showViewFileButton}\n      onViewFile={onViewFile}\n\n      showCommentButton={showCommentButton}\n      onCommentAnnotation={onCommentAnnotation}\n      isDateFreeTextCanEdit={isDateFreeTextCanEdit}\n      isDatePickerOpen={isDatePickerOpen}\n      handleDateChange={handleDateChange}\n      onDatePickerShow={onDatePickerShow}\n      isCalibrationPopupOpen={isCalibrationPopupOpen}\n\n      showEditStyleButton={showEditStyleButton}\n      isStylePopupOpen={isStylePopupOpen}\n      hideSnapModeCheckbox={hideSnapModeCheckbox}\n      openEditStylePopup={() => setIsStylePopupOpen(true)}\n      closeEditStylePopup={() => setIsStylePopupOpen(false)}\n      annotationStyle={annotationStyle}\n      onResize={onResize}\n\n      showContentEditButton={showContentEditButton}\n      onEditContent={onEditContent}\n      openContentEditDeleteWarningModal={openContentEditDeleteWarningModal}\n\n      isAppearanceSignature={isAppearanceSignature}\n      onClearAppearanceSignature={onClearAppearanceSignature}\n\n      showRedactionButton={showRedactionButton}\n      onApplyRedaction={onApplyRedaction}\n\n      showGroupButton={showGroupButton}\n      onGroupAnnotations={onGroupAnnotations}\n      showUngroupButton={showUngroupButton}\n      onUngroupAnnotations={onUngroupAnnotations}\n\n      showFormFieldButton={showFormFieldButton}\n      onOpenFormField={onOpenFormField}\n\n      showDeleteButton={showDeleteButton}\n      onDeleteAnnotation={onDeleteAnnotation}\n\n      showLinkButton={showLinkButton}\n      hasAssociatedLink={hasAssociatedLink}\n      linkAnnotationToURL={linkAnnotationToURL}\n\n      showFileDownloadButton={showFileDownloadButton}\n      downloadFileAttachment={downloadFileAttachment}\n\n      showAudioPlayButton={showAudioPlayButton}\n      handlePlaySound={handlePlaySound}\n\n      showCalibrateButton={showCalibrateButton}\n      onOpenCalibration={onOpenCalibration}\n    />\n  );\n};\n\nAnnotationPopupContainer.propTypes = propTypes;\n\nexport default memo(AnnotationPopupContainer);\n","import AnnotationPopupContainer from './AnnotationPopupContainer';\n\nexport default AnnotationPopupContainer;"],"sourceRoot":""}