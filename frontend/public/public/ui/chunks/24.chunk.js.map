{"version":3,"sources":["webpack:///./src/ui/src/components/ColorPickerOverlay/ColorPickerOverlay.scss?886a","webpack:///./src/ui/src/components/ColorPickerOverlay/ColorPickerOverlay.scss","webpack:///./src/ui/src/components/Header/OfficeHeader.scss?e686","webpack:///./src/ui/src/components/Header/OfficeHeader.scss","webpack:///./src/ui/src/components/ColorPickerOverlay/ColorPickerOverlay.js","webpack:///./src/ui/src/components/ColorPickerOverlay/index.js","webpack:///./src/ui/src/constants/officeEditor.js","webpack:///./src/ui/src/components/Header/OfficeEditorToolsHeader.js"],"names":["api","content","__esModule","default","module","i","options","styleTag","webComponents","document","getElementsByTagName","length","clonedStyleTags","webComponent","shadowRoot","appendChild","onload","forEach","styleNode","innerHTML","cloneNode","push","head","exports","locals","ColorPickerOverlay","color","onStyleChange","portalElementId","useState","left","right","top","position","setPosition","overlayRef","useRef","isOpen","useSelector","state","selectors","isElementOpen","dispatch","useDispatch","useOnClickOutside","e","menuButton","querySelector","contains","target","actions","closeElements","useLayoutEffect","onResize","overlayPosition","getOverlayPositionBasedOn","window","addEventListener","removeEventListener","createPortal","DataElementWrapper","data-element","className","classNames","Popup","open","closed","style","ref","ColorPalette","property","useMobileMinMaxWidth","ColorPalettePicker","enableEdit","getRootNode","getElementById","LINE_SPACING_OPTIONS","JUSTIFICATION_OPTIONS","LIST_OPTIONS","availableStylePresetMap","fontSize","availablePointSizes","focusContent","isSafari","isIOS","core","getViewerElement","focus","TextStyles","cursorProperties","isBold","isItalic","isUnderline","ActionButton","isActive","onClick","getOfficeEditor","isTextSelected","toggleSelectedTextStyle","setCursorStyle","bold","dataElement","title","img","italic","underline","underlineStyle","JustificationOptions","justification","updateParagraphStyle","getDocumentViewer","clearSelection","ListOptions","listType","toggleListSelection","OfficeEditorToolsHeader","DataElement","OFFICE_EDITOR_TOOLS_HEADER","getOfficeEditorCursorProperties","getOfficeEditorSelectionProperties","getAvailableFontFaces","getActiveTheme","getCSSFontValues","shallowEqual","selectionProperties","availableFontFaces","activeTheme","cssFontValues","containerWidth","setContainerWidth","initialHeaderWidth","setInitialHeaderWidth","visibleGroupCount","setVisibleGroupCount","showMoreTools","setShowMoreTools","useEffect","onCursorPropertiesUpdated","setOfficeEditorCursorProperties","onSelectionPropertiesUpdated","setOfficeEditorSelectionProperties","getDocument","fontFace","includes","addOfficeEditorAvailableFontFace","actualContainerWidth","pointSize","pointSizeSelectionKey","undefined","toString","lineHeight","lineSpacing","Object","values","reduce","a","b","aDiff","Math","abs","bDiff","calculateLineSpacing","fontPointSize","isLightMode","Theme","LIGHT","wvFontColor","Core","Annotations","Color","r","g","useColorIconBorder","convertCursorToStylePreset","paragraphTextStyle","currentColor","stylePreset","rgbaToHex","slice","keys","bounds","width","measureRef","Dropdown","items","onClickItem","item","parseInt","fontColor","newTextStyle","R","G","B","textStyle","setTimeout","getCustomItemStyle","padding","applyCustomStyleToButton","currentSelectionKey","updateSelectionStyle","maxHeight","customDataValidator","font","hasInput","isNaN","isSearchEnabled","ToggleElementButton","element","iconClassName","_","lineSpacingOption","displayButton"],"mappings":"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","file":"chunks/24.chunk.js","sourcesContent":["var api = require(\"!../../../../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\");\n            var content = require(\"!!../../../../../node_modules/css-loader/index.js!../../../../../node_modules/postcss-loader/src/index.js??postcss!../../../../../node_modules/sass-loader/dist/cjs.js!./ColorPickerOverlay.scss\");\n\n            content = content.__esModule ? content.default : content;\n\n            if (typeof content === 'string') {\n              content = [[module.id, content, '']];\n            }\n\nvar options = {};\n\noptions.insert = function (styleTag) {\n                const webComponents = document.getElementsByTagName('apryse-webviewer');\n                if (webComponents.length > 0) {\n                  const clonedStyleTags = [];\n                  for (let i = 0; i < webComponents.length; i++) {\n                    const webComponent = webComponents[i];\n                    if (i === 0) {\n                      webComponent.shadowRoot.appendChild(styleTag);\n                      styleTag.onload = function () {\n                        if (clonedStyleTags.length > 0) {\n                          clonedStyleTags.forEach((styleNode) => {\n                            // eslint-disable-next-line no-unsanitized/property\n                            styleNode.innerHTML = styleTag.innerHTML;\n                          });\n                        }\n                      };\n                    } else {\n                      const styleNode = styleTag.cloneNode(true);\n                      webComponent.shadowRoot.appendChild(styleNode);\n                      clonedStyleTags.push(styleNode);\n                    }\n                  }\n                } else {\n                  document.head.appendChild(styleTag);\n                }\n              };\noptions.singleton = false;\n\nvar update = api(content, options);\n\n\n\nmodule.exports = content.locals || {};","exports = module.exports = require(\"../../../../../node_modules/css-loader/lib/css-base.js\")(false);\n// imports\n\n\n// module\nexports.push([module.id, \".open.ColorPickerOverlay{visibility:visible}.closed.ColorPickerOverlay{visibility:hidden}:host{display:inline-block;container-type:inline-size;width:100%;height:100%;overflow:hidden}@media(min-width:901px){.App:not(.is-web-component) .hide-in-desktop{display:none}}@container (min-width: 901px){.hide-in-desktop{display:none}}@media(min-width:641px)and (max-width:900px){.App:not(.is-in-desktop-only-mode):not(.is-web-component) .hide-in-tablet{display:none}}@container (min-width: 641px) and (max-width: 900px){.App.is-web-component:not(.is-in-desktop-only-mode) .hide-in-tablet{display:none}}@media(max-width:640px)and (min-width:431px){.App:not(.is-web-component) .hide-in-mobile{display:none}}@container (max-width: 640px) and (min-width: 431px){.App.is-web-component .hide-in-mobile{display:none}}@media(max-width:430px){.App:not(.is-web-component) .hide-in-small-mobile{display:none}}@container (max-width: 430px){.App.is-web-component .hide-in-small-mobile{display:none}}.always-hide{display:none}.ColorPickerOverlay{position:absolute;z-index:70;justify-content:center;align-items:center}.ColorPickerOverlay:empty{padding:0}.ColorPickerOverlay .buttons{display:flex}.ColorPickerOverlay .Button{margin:4px;width:32px;height:32px}@media(max-width:640px){.App:not(.is-in-desktop-only-mode):not(.is-web-component) .ColorPickerOverlay .Button{width:42px;height:42px}}@container (max-width: 640px){.App.is-web-component:not(.is-in-desktop-only-mode) .ColorPickerOverlay .Button{width:42px;height:42px}}.ColorPickerOverlay .Button:hover{background:var(--popup-button-hover)}.ColorPickerOverlay .Button .Icon{width:18px;height:18px}@media(max-width:640px){.App:not(.is-in-desktop-only-mode):not(.is-web-component) .ColorPickerOverlay .Button .Icon{width:24px;height:24px}}@container (max-width: 640px){.App.is-web-component:not(.is-in-desktop-only-mode) .ColorPickerOverlay .Button .Icon{width:24px;height:24px}}.is-vertical.ColorPickerOverlay .Button.main-menu-button{width:100%;border-radius:0;justify-content:flex-start;padding-left:var(--padding-small);padding-right:var(--padding-small);margin:0 0 var(--padding-tiny) 0}.is-vertical.ColorPickerOverlay .Button.main-menu-button:first-child{margin-top:var(--padding-tiny)}@media(max-width:640px){.App:not(.is-in-desktop-only-mode):not(.is-web-component) .is-vertical.ColorPickerOverlay .Button.main-menu-button{width:100%;height:32px}}@container (max-width: 640px){.App.is-web-component:not(.is-in-desktop-only-mode) .is-vertical.ColorPickerOverlay .Button.main-menu-button{width:100%;height:32px}}.is-vertical.ColorPickerOverlay .Button.main-menu-button .Icon{margin-right:10px}.is-vertical.ColorPickerOverlay .Button.main-menu-button span{white-space:nowrap}@-webkit-keyframes bottom-up{0%{transform:translateY(100%)}to{transform:translateY(0)}}@keyframes bottom-up{0%{transform:translateY(100%)}to{transform:translateY(0)}}@-webkit-keyframes up-bottom{0%{transform:translateY(0)}to{transform:translateY(100%)}}@keyframes up-bottom{0%{transform:translateY(0)}to{transform:translateY(100%)}}.ColorPickerOverlay{border-radius:4px;box-shadow:0 0 3px 0 var(--document-box-shadow);background:var(--component-background);display:flex;flex-direction:column;padding:16px}\", \"\"]);\n\n// exports\nexports.locals = {\n\t\"LEFT_HEADER_WIDTH\": \"41px\",\n\t\"RIGHT_HEADER_WIDTH\": \"41px\"\n};","var api = require(\"!../../../../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\");\n            var content = require(\"!!../../../../../node_modules/css-loader/index.js!../../../../../node_modules/postcss-loader/src/index.js??postcss!../../../../../node_modules/sass-loader/dist/cjs.js!./OfficeHeader.scss\");\n\n            content = content.__esModule ? content.default : content;\n\n            if (typeof content === 'string') {\n              content = [[module.id, content, '']];\n            }\n\nvar options = {};\n\noptions.insert = function (styleTag) {\n                const webComponents = document.getElementsByTagName('apryse-webviewer');\n                if (webComponents.length > 0) {\n                  const clonedStyleTags = [];\n                  for (let i = 0; i < webComponents.length; i++) {\n                    const webComponent = webComponents[i];\n                    if (i === 0) {\n                      webComponent.shadowRoot.appendChild(styleTag);\n                      styleTag.onload = function () {\n                        if (clonedStyleTags.length > 0) {\n                          clonedStyleTags.forEach((styleNode) => {\n                            // eslint-disable-next-line no-unsanitized/property\n                            styleNode.innerHTML = styleTag.innerHTML;\n                          });\n                        }\n                      };\n                    } else {\n                      const styleNode = styleTag.cloneNode(true);\n                      webComponent.shadowRoot.appendChild(styleNode);\n                      clonedStyleTags.push(styleNode);\n                    }\n                  }\n                } else {\n                  document.head.appendChild(styleTag);\n                }\n              };\noptions.singleton = false;\n\nvar update = api(content, options);\n\n\n\nmodule.exports = content.locals || {};","exports = module.exports = require(\"../../../../../node_modules/css-loader/lib/css-base.js\")(false);\n// imports\n\n\n// module\nexports.push([module.id, \":host{display:inline-block;container-type:inline-size;width:100%;height:100%;overflow:hidden}@media(min-width:901px){.App:not(.is-web-component) .hide-in-desktop{display:none}}@container (min-width: 901px){.hide-in-desktop{display:none}}@media(min-width:641px)and (max-width:900px){.App:not(.is-in-desktop-only-mode):not(.is-web-component) .hide-in-tablet{display:none}}@container (min-width: 641px) and (max-width: 900px){.App.is-web-component:not(.is-in-desktop-only-mode) .hide-in-tablet{display:none}}@media(max-width:640px)and (min-width:431px){.App:not(.is-web-component) .hide-in-mobile{display:none}}@container (max-width: 640px) and (min-width: 431px){.App.is-web-component .hide-in-mobile{display:none}}@media(max-width:430px){.App:not(.is-web-component) .hide-in-small-mobile{display:none}}@container (max-width: 430px){.App.is-web-component .hide-in-small-mobile{display:none}}.always-hide{display:none}.MainHeader.OfficeEditorTools{padding:0 8px;align-items:center;flex-direction:row}.MainHeader.OfficeEditorTools .HeaderItems{width:auto}.MainHeader.OfficeEditorTools .HeaderItems .Dropdown{margin-left:8px}.MainHeader.OfficeEditorTools .HeaderItems .Dropdown.small-dropdown{width:80px!important}.MainHeader.OfficeEditorTools .HeaderItems .Dropdown.large-dropdown{width:160px!important}.MainHeader.OfficeEditorTools .HeaderItems .Dropdown .picked-option{text-align:left}.MainHeader.OfficeEditorTools .HeaderItems .line-spacing-dropdown .Dropdown__items{top:40px}.MainHeader.OfficeEditorTools .HeaderItems .action-button-wrapper{display:flex;align-items:center;position:relative}.MainHeader.OfficeEditorTools .HeaderItems .action-button-wrapper .more-tools{position:absolute;top:46px;right:6px;width:auto;padding:0}.MainHeader.OfficeEditorTools .Button .Icon svg{vertical-align:middle}\", \"\"]);\n\n// exports\nexports.locals = {\n\t\"LEFT_HEADER_WIDTH\": \"41px\",\n\t\"RIGHT_HEADER_WIDTH\": \"41px\"\n};","import React, { useState, useLayoutEffect, useRef } from 'react';\nimport { useSelector, useDispatch } from 'react-redux';\nimport { createPortal } from 'react-dom';\nimport selectors from 'selectors';\nimport DataElementWrapper from 'components/DataElementWrapper';\nimport ColorPalette from 'components/ColorPalette';\nimport ColorPalettePicker from 'components/ColorPalettePicker';\nimport actions from 'actions';\n\nimport useOnClickOutside from 'hooks/useOnClickOutside';\nimport getOverlayPositionBasedOn from 'helpers/getOverlayPositionBasedOn';\nimport classNames from 'classnames';\nimport getRootNode from 'helpers/getRootNode';\n\nimport './ColorPickerOverlay.scss';\n\nconst ColorPickerOverlay = ({\n  color,\n  onStyleChange,\n  portalElementId = 'app',\n}) => {\n  const [position, setPosition] = useState(() => ({ left: '555px', right: 'auto', top: 'auto' }));\n  const overlayRef = useRef(null);\n  const [\n    isOpen,\n  ] = useSelector((state) => [\n    selectors.isElementOpen(state, 'colorPickerOverlay'),\n  ]);\n\n  const dispatch = useDispatch();\n\n  const onClickOutside = (e) => {\n    const menuButton = document.querySelector('[data-element=\"textColorButton\"]');\n    const clickedMenuButton = menuButton?.contains(e.target);\n    if (!clickedMenuButton) {\n      dispatch(actions.closeElements(['colorPickerOverlay']));\n    }\n  };\n  useOnClickOutside(overlayRef, onClickOutside);\n\n  useLayoutEffect(() => {\n    if (isOpen) {\n      const onResize = () => {\n        const overlayPosition = getOverlayPositionBasedOn('textColorButton', overlayRef);\n        setPosition(overlayPosition);\n      };\n      onResize();\n\n      window.addEventListener('resize', onResize);\n      return () => window.removeEventListener('resize', onResize);\n    }\n  }, [isOpen]);\n\n  return createPortal(\n    <DataElementWrapper\n      data-element='colorPickerOverlay'\n      className={classNames({\n        ColorPickerOverlay: true,\n        Popup: true,\n        open: isOpen,\n        closed: !isOpen\n      })}\n      style={position}\n      ref={overlayRef}\n    >\n      <ColorPalette\n        color={color}\n        property='TextColor'\n        onStyleChange={onStyleChange}\n        useMobileMinMaxWidth\n      />\n      <ColorPalettePicker\n        color={color}\n        onStyleChange={onStyleChange}\n        enableEdit\n      />\n    </DataElementWrapper>,\n    getRootNode().getElementById(portalElementId),\n  );\n};\n\nexport default ColorPickerOverlay;","import ColorPickerOverlay from './ColorPickerOverlay';\n\nexport default ColorPickerOverlay;","export const LINE_SPACING_OPTIONS = {\n  'Single': 1,\n  '1.15': 1.15,\n  '1.5': 1.5,\n  'Double': 2,\n};\n\nexport const JUSTIFICATION_OPTIONS = {\n  Left: 'left',\n  Center: 'center',\n  Right: 'right',\n  Both: 'both'\n};\n\nexport const LIST_OPTIONS = {\n  Ordered: 'ordered',\n  Unordered: 'unordered',\n};\n\nexport const DEFAULT_POINT_SIZE = 11;","import React, { useEffect, useState } from 'react';\nimport { useSelector, useDispatch, shallowEqual } from 'react-redux';\nimport Dropdown from 'components/Dropdown';\nimport ActionButton from 'components/ActionButton';\nimport ToggleElementButton from 'components/ToggleElementButton';\nimport DataElementWrapper from 'components/DataElementWrapper';\nimport DataElement from 'constants/dataElement';\nimport actions from 'actions';\nimport core from 'core';\nimport selectors from 'selectors';\nimport ColorPickerOverlay from 'components/ColorPickerOverlay';\nimport { rgbaToHex } from 'src/helpers/color';\nimport Theme from 'src/constants/theme';\nimport {\n  LINE_SPACING_OPTIONS,\n  JUSTIFICATION_OPTIONS,\n  LIST_OPTIONS,\n  DEFAULT_POINT_SIZE,\n} from 'src/constants/officeEditor';\nimport Measure from 'react-measure';\n\nimport { isSafari, isIOS } from 'helpers/device';\n\nimport './Header.scss';\nimport './OfficeHeader.scss';\n\nconst availableStylePresetMap = {\n  'Normal Text': {\n    fontSize: '11pt',\n    color: '#000000',\n  },\n  'Title': {\n    fontSize: '26pt',\n    color: '#000000',\n  },\n  'Subtitle': {\n    fontSize: '15pt',\n    color: '#666666',\n  },\n  'Heading 1': {\n    fontSize: '20pt',\n    color: '#000000',\n  },\n  'Heading 2': {\n    fontSize: '16pt',\n    color: '#000000',\n  },\n  'Heading 3': {\n    fontSize: '14pt',\n    color: '#434343',\n  },\n  'Heading 4': {\n    fontSize: '12pt',\n    color: '#666666',\n  },\n  'Heading 5': {\n    fontSize: '11pt',\n    color: '#666666',\n  },\n};\nconst availablePointSizes = ['8', '9', '10', '11', '12', '14', '18', '24', '30', '36', '48', '60', '72'];\nconst listOptionsWidth = 121;\nconst justificationOptionsWidth = 209;\nconst moreButtonWidth = 77;\n\nconst convertCoreColorToWebViewerColor = (color) => {\n  if (!color) {\n    return new window.Core.Annotations.Color(0, 0, 0, 1);\n  }\n\n  return new window.Core.Annotations.Color(\n    color.r,\n    color.g,\n    color.b,\n    1,\n  );\n};\n\nconst focusContent = () => {\n  // On safari, focusing the viewer element makes the screen jump up.\n  // So the toolbars disappear.\n  if (isSafari || isIOS) {\n    return;\n  }\n  // focus so that after clicking you can still input text\n  core.getViewerElement().focus();\n};\n\nconst TextStyles = ({ cursorProperties, isBold, isItalic, isUnderline }) => {\n  return (\n    <>\n      <ActionButton\n        isActive={isBold}\n        onClick={() => {\n          if (core.getOfficeEditor().isTextSelected()) {\n            core.getOfficeEditor().toggleSelectedTextStyle('bold');\n          } else {\n            core.getOfficeEditor().setCursorStyle({ bold: !cursorProperties.bold });\n          }\n          focusContent();\n        }}\n        dataElement='office-editor-bold'\n        title='officeEditor.bold'\n        img='icon-text-bold'\n      />\n      <ActionButton\n        isActive={isItalic}\n        onClick={() => {\n          if (core.getOfficeEditor().isTextSelected()) {\n            core.getOfficeEditor().toggleSelectedTextStyle('italic');\n          } else {\n            core.getOfficeEditor().setCursorStyle({ italic: !cursorProperties.italic });\n          }\n          focusContent();\n        }}\n        dataElement='office-editor-italic'\n        title='officeEditor.italic'\n        img='icon-text-italic'\n      />\n      <ActionButton\n        isActive={isUnderline}\n        onClick={() => {\n          if (core.getOfficeEditor().isTextSelected()) {\n            core.getOfficeEditor().toggleSelectedTextStyle('underline');\n          } else {\n            core.getOfficeEditor().setCursorStyle({\n              underline: cursorProperties.underlineStyle === 'none'\n            });\n          }\n          focusContent();\n        }}\n        dataElement='office-editor-underline'\n        title='officeEditor.underline'\n        img='icon-text-underline'\n      />\n    </>\n  );\n};\n\nconst JustificationOptions = ({ justification }) => {\n  return (\n    <>\n      <ActionButton\n        isActive={justification === JUSTIFICATION_OPTIONS.Left}\n        dataElement='office-editor-left-align'\n        title='officeEditor.leftAlign'\n        img='icon-menu-left-align'\n        onClick={() => {\n          core.getOfficeEditor().updateParagraphStyle({\n            justification: 'left'\n          });\n          core.getOfficeEditor().setCursorStyle({\n            justification: 'left'\n          });\n\n          focusContent();\n          core.getDocumentViewer().clearSelection();\n        }}\n      />\n      <ActionButton\n        isActive={justification === JUSTIFICATION_OPTIONS.Center}\n        dataElement='office-editor-center-align'\n        title='officeEditor.centerAlign'\n        img='icon-menu-centre-align'\n        onClick={() => {\n          core.getOfficeEditor().updateParagraphStyle({\n            justification: 'center'\n          });\n          core.getOfficeEditor().setCursorStyle({\n            justification: 'center'\n          });\n\n          focusContent();\n          core.getDocumentViewer().clearSelection();\n        }}\n      />\n      <ActionButton\n        isActive={justification === JUSTIFICATION_OPTIONS.Right}\n        dataElement='office-editor-right-align'\n        title='officeEditor.rightAlign'\n        img='icon-menu-right-align'\n        onClick={() => {\n          core.getOfficeEditor().updateParagraphStyle({\n            justification: 'right'\n          });\n          core.getOfficeEditor().setCursorStyle({\n            justification: 'right'\n          });\n\n          focusContent();\n          core.getDocumentViewer().clearSelection();\n        }}\n      />\n      <ActionButton\n        isActive={justification === JUSTIFICATION_OPTIONS.Both}\n        dataElement='office-editor-justify'\n        title='officeEditor.justify'\n        img='icon-menu-both-align'\n        onClick={() => {\n          core.getOfficeEditor().updateParagraphStyle({\n            justification: 'both'\n          });\n          core.getOfficeEditor().setCursorStyle({\n            justification: 'both'\n          });\n\n          focusContent();\n          core.getDocumentViewer().clearSelection();\n        }}\n      />\n    </>\n  );\n};\n\nconst ListOptions = ({ listType }) => {\n  return (\n    <>\n      <ActionButton\n        isActive={listType === LIST_OPTIONS.Unordered}\n        dataElement='office-editor-bullet-list'\n        title='officeEditor.bulletList'\n        img='icon-office-editor-bullet-list'\n        onClick={() => {\n          core.getOfficeEditor().toggleListSelection(LIST_OPTIONS.Unordered);\n\n          focusContent();\n        }}\n      />\n      <ActionButton\n        isActive={listType === LIST_OPTIONS.Ordered}\n        dataElement='office-editor-number-list'\n        title='officeEditor.numberList'\n        img='icon-office-number-list'\n        onClick={() => {\n          core.getOfficeEditor().toggleListSelection(LIST_OPTIONS.Ordered);\n\n          focusContent();\n        }}\n      />\n    </>\n  );\n};\n\nconst OfficeEditorToolsHeader = () => {\n  const dispatch = useDispatch();\n  const [\n    isOpen,\n    cursorProperties,\n    selectionProperties,\n    availableFontFaces,\n    activeTheme,\n    cssFontValues,\n  ] = useSelector(\n    (state) => [\n      selectors.isElementOpen(state, DataElement.OFFICE_EDITOR_TOOLS_HEADER),\n      selectors.getOfficeEditorCursorProperties(state),\n      selectors.getOfficeEditorSelectionProperties(state),\n      selectors.getAvailableFontFaces(state),\n      selectors.getActiveTheme(state),\n      selectors.getCSSFontValues(state),\n    ],\n    shallowEqual\n  );\n\n  const [containerWidth, setContainerWidth] = useState(0);\n  const [initialHeaderWidth, setInitialHeaderWidth] = useState(0);\n  const [visibleGroupCount, setVisibleGroupCount] = useState(6);\n  const [showMoreTools, setShowMoreTools] = useState(false);\n\n  useEffect(() => {\n    const onCursorPropertiesUpdated = (cursorProperties) => {\n      dispatch(actions.setOfficeEditorCursorProperties(cursorProperties));\n    };\n    const onSelectionPropertiesUpdated = (selectionProperties) => {\n      dispatch(actions.setOfficeEditorSelectionProperties(selectionProperties));\n    };\n\n    core.getDocument()?.addEventListener('cursorPropertiesUpdated', onCursorPropertiesUpdated);\n    core.getDocument()?.addEventListener('selectionPropertiesUpdated', onSelectionPropertiesUpdated);\n\n    return () => {\n      core.getDocument()?.removeEventListener('selectionPropertiesUpdated', onSelectionPropertiesUpdated);\n      core.getDocument()?.removeEventListener('cursorPropertiesUpdated', onCursorPropertiesUpdated);\n    };\n  }, []);\n\n  useEffect(() => {\n    if (cursorProperties.fontFace && !availableFontFaces.includes(cursorProperties.fontFace)) {\n      dispatch(actions.addOfficeEditorAvailableFontFace(cursorProperties.fontFace));\n    }\n  }, [availableFontFaces, cursorProperties]);\n\n  useEffect(() => {\n    if (containerWidth === 0 || initialHeaderWidth === 0) {\n      return;\n    }\n\n    const actualContainerWidth = containerWidth - 16;\n    if (\n      actualContainerWidth >= initialHeaderWidth\n    ) {\n      setVisibleGroupCount(6);\n    } else if (\n      actualContainerWidth < initialHeaderWidth &&\n      actualContainerWidth >= (initialHeaderWidth - listOptionsWidth + moreButtonWidth)\n    ) {\n      setVisibleGroupCount(5);\n    } else if (\n      actualContainerWidth < (initialHeaderWidth - listOptionsWidth + moreButtonWidth) &&\n      actualContainerWidth >= (initialHeaderWidth - listOptionsWidth - justificationOptionsWidth + moreButtonWidth) &&\n      actualContainerWidth >= 858 // HeaderItems's width when on small devices (screen width < 900px)\n    ) {\n      setVisibleGroupCount(4);\n    } else {\n      setVisibleGroupCount(3);\n    }\n  }, [containerWidth, initialHeaderWidth]);\n\n  const calculateLineSpacing = (lineHeight, fontSize) => {\n    const lineSpacing = lineHeight / fontSize;\n\n    // Sometimes we get floating points so we locate the closest line spacing option\n    const roundedLineSpacing = Object.values(LINE_SPACING_OPTIONS).reduce((a, b) => {\n      const aDiff = Math.abs(a - lineSpacing);\n      const bDiff = Math.abs(b - lineSpacing);\n\n      if (aDiff === bDiff) {\n        return a < b ? a : b;\n      }\n      return bDiff < aDiff ? b : a;\n    });\n\n    switch (roundedLineSpacing) {\n      case 1:\n        return 'Single';\n      case 1.15:\n        return '1.15';\n      case 1.5:\n        return '1.5';\n      case 2:\n        return 'Double';\n      default:\n        return 'Single';\n    }\n  };\n\n  const isTextSelected = core.getOfficeEditor().isTextSelected();\n  const isBold = isTextSelected ? selectionProperties.bold : cursorProperties.bold;\n  const isItalic = isTextSelected ? selectionProperties.italic : cursorProperties.italic;\n  const isUnderline = isTextSelected ? selectionProperties.underlineStyle === 'single' : cursorProperties.underlineStyle === 'single';\n  const fontFace = isTextSelected ? selectionProperties.fontFace : cursorProperties.fontFace;\n  const pointSize = isTextSelected ? selectionProperties.pointSize : cursorProperties.pointSize;\n  const pointSizeSelectionKey = pointSize === undefined ? undefined : pointSize.toString();\n  const justification = isTextSelected ? selectionProperties.justification : cursorProperties.justification;\n  const lineHeight = calculateLineSpacing(\n    isTextSelected ? selectionProperties.lineHeight : cursorProperties.lineHeight,\n    cursorProperties.fontPointSize || DEFAULT_POINT_SIZE,\n  );\n  const listType = isTextSelected ? selectionProperties.listType : cursorProperties.listType;\n\n  const isLightMode = activeTheme === Theme.LIGHT;\n  const wvFontColor = convertCoreColorToWebViewerColor(cursorProperties.color);\n  const useColorIconBorder = isLightMode ? wvFontColor.toString() === 'rgba(255,255,255,1)' : wvFontColor.toString() === 'rgba(0,0,0,1)';\n\n  const convertCursorToStylePreset = (cursorProperties) => {\n    const {\n      pointSize,\n      color: currentColor\n    } = cursorProperties.paragraphTextStyle || cursorProperties;\n\n    let stylePreset = 'Normal Text';\n    if (!pointSize || !currentColor) {\n      return stylePreset;\n    }\n\n    const fontSize = `${pointSize}pt`;\n    let color = '#000000';\n    if (color) {\n      color = rgbaToHex(\n        currentColor.r,\n        currentColor.g,\n        currentColor.b\n      ).slice(0, -2);\n    }\n\n    Object.keys(availableStylePresetMap).forEach((style) => {\n      if (\n        availableStylePresetMap[style].fontSize === fontSize &&\n        availableStylePresetMap[style].color === color\n      ) {\n        stylePreset = style;\n      }\n    });\n\n    return stylePreset;\n  };\n\n  return isOpen ? (\n    <DataElementWrapper\n      dataElement={DataElement.OFFICE_EDITOR_TOOLS_HEADER}\n      className='HeaderToolsContainer'\n    >\n      <Measure\n        bounds\n        onResize={({ bounds }) => {\n          setContainerWidth(bounds.width);\n        }}\n      >\n        {({ measureRef }) => (\n          <div\n            className='MainHeader Tools OfficeEditorTools'\n            ref={measureRef}\n          >\n            <Measure\n              bounds\n              onResize={({ bounds }) => {\n                (initialHeaderWidth === 0) && setInitialHeaderWidth(bounds.width);\n              }}\n            >\n              {({ measureRef }) => (\n                <div\n                  className=\"HeaderItems\"\n                  ref={measureRef}\n                >\n                  <Dropdown\n                    items={Object.keys(availableStylePresetMap)}\n                    onClickItem={(item) => {\n                      const stylePreset = availableStylePresetMap[item];\n                      const fontPointSize = parseInt(stylePreset.fontSize, 10);\n                      const fontColor = new window.Core.Annotations.Color(stylePreset.color);\n                      const parsedFontColor = {\n                        r: fontColor.R,\n                        g: fontColor.G,\n                        b: fontColor.B,\n                        a: 255,\n                      };\n\n                      const newTextStyle = {\n                        bold: false,\n                        italic: false,\n                        underline: false,\n                        pointSize: fontPointSize,\n                        color: parsedFontColor\n                      };\n\n                      core.getOfficeEditor().updateParagraphStyle({\n                        textStyle: newTextStyle,\n                      });\n                      core.getOfficeEditor().setCursorStyle(newTextStyle);\n\n                      // setTimeout hack needed because dropdown closing from click is async?\n                      setTimeout(() => {\n                        // focus so that after clicking you can still input text\n                        core.getViewerElement().focus();\n                      });\n                      core.getDocumentViewer().clearSelection();\n                    }}\n                    getCustomItemStyle={(item) => ({ ...availableStylePresetMap[item], padding: '20px 10px', color: 'var(--gray-12)' })}\n                    applyCustomStyleToButton={false}\n                    currentSelectionKey={convertCursorToStylePreset(cursorProperties)}\n                    className=\"large-dropdown\"\n                    dataElement=\"office-editor-text-format\"\n                  />\n                  <Dropdown\n                    items={availableFontFaces}\n                    onClickItem={(fontFace) => {\n                      core.getOfficeEditor().isTextSelected() && core.getOfficeEditor().updateSelectionStyle({ fontFace });\n\n                      core.getOfficeEditor().setCursorStyle({ fontFace });\n\n                      // setTimeout hack needed because dropdown closing from click is async?\n                      setTimeout(() => {\n                        // focus so that after clicking you can still input text\n                        core.getViewerElement().focus();\n                      });\n                    }}\n                    getCustomItemStyle={(item) => ({ ...cssFontValues[item] })}\n                    maxHeight={500}\n                    customDataValidator={(font) => availableFontFaces.includes(font)}\n                    className=\"large-dropdown\"\n                    dataElement=\"office-editor-font\"\n                    currentSelectionKey={fontFace}\n                    hasInput\n                  />\n                  <Dropdown\n                    items={availablePointSizes}\n                    onClickItem={(pointSize) => {\n                      let fontPointSize = parseInt(pointSize, 10);\n\n                      if (isNaN(fontPointSize)) {\n                        fontPointSize = DEFAULT_POINT_SIZE;\n                      }\n\n                      // TODO: Setting a pointsize of 96 or higher will cause cursor positions array\n                      // to be empty for the span\n                      // Actually, every large point size seems to break something.\n                      if (fontPointSize > 72) {\n                        fontPointSize = 72;\n                      }\n\n                      if (core.getOfficeEditor().isTextSelected()) {\n                        core.getOfficeEditor().updateSelectionStyle({\n                          pointSize: fontPointSize\n                        });\n                      }\n\n                      core.getOfficeEditor().setCursorStyle({\n                        pointSize: fontPointSize\n                      });\n\n                      // setTimeout hack needed because dropdown closing from click is async?\n                      setTimeout(() => {\n                        // focus so that after clicking you can still input text\n                        core.getViewerElement().focus();\n                      });\n                    }}\n                    currentSelectionKey={pointSizeSelectionKey}\n                    className=\"small-dropdown\"\n                    dataElement=\"office-editor-font-size\"\n                    hasInput\n                    isSearchEnabled={false}\n                  />\n                  {(visibleGroupCount >= 4) && (\n                    <>\n                      <div className=\"divider\" />\n                      <TextStyles\n                        cursorProperties={cursorProperties}\n                        isBold={isBold}\n                        isItalic={isItalic}\n                        isUnderline={isUnderline}\n                      />\n                    </>\n                  )}\n                  <div className=\"divider\" />\n                  <ToggleElementButton\n                    dataElement='textColorButton'\n                    title='officeEditor.textColor'\n                    img='icon-office-editor-circle'\n                    element='colorPickerOverlay'\n                    color={wvFontColor.toString()}\n                    iconClassName={useColorIconBorder ? 'icon-border' : ''}\n                  />\n                  <ColorPickerOverlay\n                    onStyleChange={(_, color) => {\n                      const fontColor = {\n                        r: color.R,\n                        g: color.G,\n                        b: color.B,\n                        a: 255,\n                      };\n\n                      core.getOfficeEditor().isTextSelected() && core.getOfficeEditor().updateSelectionStyle({ fontColor });\n\n                      core.getOfficeEditor().setCursorStyle({ fontColor });\n\n                      dispatch(actions.closeElements(['colorPickerOverlay']));\n\n                      // focus so that after clicking you can still input text\n                      core.getViewerElement().focus();\n                    }}\n                    color={wvFontColor}\n                  />\n                  {(visibleGroupCount >= 5) && (\n                    <>\n                      <div className=\"divider\" />\n                      <JustificationOptions justification={justification} />\n                    </>\n                  )}\n                  <div className=\"divider\" />\n                  <Dropdown\n                    items={Object.keys(LINE_SPACING_OPTIONS)}\n                    onClickItem={(lineSpacingOption) => {\n                      const lineSpacing = LINE_SPACING_OPTIONS[lineSpacingOption];\n                      const lineHeight = lineSpacing * (cursorProperties.pointSize || DEFAULT_POINT_SIZE);\n                      core.getOfficeEditor().updateParagraphStyle({\n                        lineSpacing: lineHeight\n                      });\n\n                      // focus so that after clicking you can still input text\n                      core.getViewerElement().focus();\n                      core.getDocumentViewer().clearSelection();\n                    }}\n                    currentSelectionKey={lineHeight}\n                    className=\"small-dropdown line-spacing-dropdown\"\n                    dataElement=\"office-editor-line-spacing\"\n                    displayButton={(isOpen) => (\n                      <ActionButton\n                        title='officeEditor.lineSpacing'\n                        img='icon-office-editor-line-spacing'\n                        isActive={isOpen}\n                        onClick={() => { }}\n                      />\n                    )}\n                  />\n                  {(visibleGroupCount === 6) && (\n                    <>\n                      <div className=\"divider\" />\n                      <ListOptions listType={listType} />\n                    </>\n                  )}\n                  {(visibleGroupCount < 6) && (\n                    <>\n                      <div className=\"divider\" />\n                      <div className=\"action-button-wrapper\">\n                        <ActionButton\n                          className=\"tool-group-button\"\n                          isActive={showMoreTools}\n                          dataElement='office-editor-more-tools'\n                          title='action.more'\n                          img='icon-tools-more-vertical'\n                          onClick={() => setShowMoreTools(!showMoreTools)}\n                        />\n                        {showMoreTools && (\n                          <div className=\"more-tools Header Tools OfficeEditorTools\">\n                            <div className=\"HeaderItems\">\n                              {(visibleGroupCount < 4) && (\n                                <>\n                                  <TextStyles\n                                    cursorProperties={cursorProperties}\n                                    isBold={isBold}\n                                    isItalic={isItalic}\n                                    isUnderline={isUnderline}\n                                  />\n                                  <div className=\"divider\" />\n                                </>\n                              )}\n                              {(visibleGroupCount < 5) && (\n                                <>\n                                  <JustificationOptions justification={justification} />\n                                  <div className=\"divider\" />\n                                </>\n                              )}\n                              {(visibleGroupCount < 6) && (\n                                <ListOptions listType={listType} />\n                              )}\n                            </div>\n                          </div>\n                        )}\n                      </div>\n                    </>\n                  )}\n                </div>\n              )}\n            </Measure>\n          </div>\n        )}\n      </Measure>\n    </DataElementWrapper>\n  ) : null;\n};\n\nexport default OfficeEditorToolsHeader;\n"],"sourceRoot":""}